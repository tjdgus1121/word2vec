<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‹¨ì–´ì‡ê¸° - AI ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ê²Œì„</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Do+Hyeon&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Noto Sans KR', sans-serif;
        }
        h1, h2, h3, .title-font {
            font-family: 'Do Hyeon', sans-serif;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .animate-slideDown {
            animation: slideDown 0.3s ease;
        }
        
        .animate-pulse-custom {
            animation: pulse 1s ease-in-out infinite;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-400 via-cyan-400 to-teal-400 min-h-screen">
    
    <!-- ì‹œì‘ í™”ë©´ -->
    <div id="startScreen" class="min-h-screen flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl shadow-2xl p-8 max-w-2xl w-full">
            <h1 class="title-font text-6xl text-center text-gray-800 mb-8">ğŸ”— ë‹¨ì–´ì‡ê¸°</h1>
            <p class="text-center text-gray-600 text-lg mb-6">AI ì½”ì‚¬ì¸ ìœ ì‚¬ë„ë¡œ ë‹¨ì–´ë¥¼ ì—°ê²°í•˜ì„¸ìš”!</p>
            
            <!-- ì„¤ëª… ë³´ê¸° ë²„íŠ¼ -->
            <div class="text-center mb-8">
                <button onclick="showInfoModal()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-xl transition-all transform hover:scale-105 text-lg">
                    ğŸ“– ì½”ì‚¬ì¸ ìœ ì‚¬ë„ë€? / ê²Œì„ ë°©ë²•
                </button>
            </div>
            
            <!-- ë‚œì´ë„ ì„ íƒ -->
            <div class="mb-8">
                <h3 class="title-font text-2xl text-center text-gray-700 mb-4">ë‚œì´ë„ ì„ íƒ</h3>
                <div class="grid grid-cols-3 gap-4">
                    <button onclick="selectDifficulty('easy')" id="diffEasy" 
                        class="difficulty-btn bg-green-100 hover:bg-green-200 border-4 border-green-400 text-green-800 p-6 rounded-xl transition-all transform hover:scale-105">
                        <div class="text-3xl mb-2">ğŸ˜Š</div>
                        <div class="font-bold text-xl">ì‰¬ì›€</div>
                        <div class="text-sm mt-2">60ì  ì´ìƒ</div>
                    </button>
                    <button onclick="selectDifficulty('medium')" id="diffMedium" 
                        class="difficulty-btn bg-yellow-100 hover:bg-yellow-200 border-4 border-yellow-400 text-yellow-800 p-6 rounded-xl transition-all transform hover:scale-105">
                        <div class="text-3xl mb-2">ğŸ¤”</div>
                        <div class="font-bold text-xl">ì¤‘ê°„</div>
                        <div class="text-sm mt-2">70ì  ì´ìƒ</div>
                    </button>
                    <button onclick="selectDifficulty('hard')" id="diffHard" 
                        class="difficulty-btn bg-red-100 hover:bg-red-200 border-4 border-red-400 text-red-800 p-6 rounded-xl transition-all transform hover:scale-105">
                        <div class="text-3xl mb-2">ğŸ”¥</div>
                        <div class="font-bold text-xl">ì–´ë ¤ì›€</div>
                        <div class="text-sm mt-2">80ì  ì´ìƒ</div>
                    </button>
                </div>
            </div>
            
            <!-- ì‹œì‘ ë²„íŠ¼ -->
            <button onclick="startGame()" id="startBtn" disabled
                class="w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white py-4 rounded-xl text-2xl title-font transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none">
                ê²Œì„ ì‹œì‘
            </button>
        </div>
    </div>
    
    <!-- ì •ë³´ ëª¨ë‹¬ -->
    <div id="infoModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4" onclick="closeInfoModal(event)">
        <div class="bg-white rounded-3xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto" onclick="event.stopPropagation()">
            <div class="sticky top-0 bg-gradient-to-r from-blue-500 to-cyan-500 text-white p-6 rounded-t-3xl">
                <h2 class="title-font text-3xl text-center">ê²Œì„ ì•ˆë‚´</h2>
            </div>
            
            <div class="p-8 space-y-6">
                <!-- ì½”ì‚¬ì¸ ìœ ì‚¬ë„ë€? -->
                <div class="bg-blue-50 border-l-4 border-blue-500 p-6 rounded-lg">
                    <h3 class="title-font text-2xl text-blue-800 mb-4">ğŸ¤– ì½”ì‚¬ì¸ ìœ ì‚¬ë„ë€?</h3>
                    <div class="space-y-3 text-gray-700 leading-relaxed">
                        <p><strong>ì½”ì‚¬ì¸ ìœ ì‚¬ë„(Cosine Similarity)</strong>ëŠ” ì¸ê³µì§€ëŠ¥ì´ ë‹¨ì–´ì˜ ì˜ë¯¸ê°€ ì–¼ë§ˆë‚˜ ë¹„ìŠ·í•œì§€ ê³„ì‚°í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.</p>
                        <p>ğŸ”¢ AIëŠ” ëª¨ë“  ë‹¨ì–´ë¥¼ <strong>ìˆ«ì ë²¡í„°</strong>ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´:</p>
                        <ul class="list-disc list-inside space-y-1 ml-4">
                            <li>"ê°•ì•„ì§€" â†’ [0.2, 0.8, 0.3, ...]</li>
                            <li>"ê³ ì–‘ì´" â†’ [0.3, 0.7, 0.4, ...]</li>
                        </ul>
                        <p>ğŸ“ ì´ ë²¡í„°ë“¤ ì‚¬ì´ì˜ <strong>ê°ë„</strong>ë¥¼ ì¸¡ì •í•˜ì—¬ 0~100ì ìœ¼ë¡œ í‘œí˜„í•©ë‹ˆë‹¤:</p>
                        <ul class="list-disc list-inside space-y-1 ml-4 bg-white p-3 rounded">
                            <li><strong>100ì </strong>: ì™„ì „íˆ ê°™ì€ ì˜ë¯¸</li>
                            <li><strong>80~99ì </strong>: ë§¤ìš° ìœ ì‚¬í•œ ì˜ë¯¸</li>
                            <li><strong>60~79ì </strong>: ê´€ë ¨ ìˆëŠ” ì˜ë¯¸</li>
                            <li><strong>0~59ì </strong>: ê´€ë ¨ì„±ì´ ë‚®ìŒ</li>
                        </ul>
                        <p>ğŸ’¡ ì˜ˆì‹œ: "ê°•ì•„ì§€"ì™€ "ê³ ì–‘ì´"ëŠ” ë‘˜ ë‹¤ ì• ì™„ë™ë¬¼ì´ë¼ ìœ ì‚¬ë„ê°€ ë†’ê³ , "ê°•ì•„ì§€"ì™€ "ìë™ì°¨"ëŠ” ê´€ë ¨ì´ ì—†ì–´ ìœ ì‚¬ë„ê°€ ë‚®ìŠµë‹ˆë‹¤.</p>
                    </div>
                </div>
                
                <!-- ê²Œì„ ë°©ë²• -->
                <div class="bg-green-50 border-l-4 border-green-500 p-6 rounded-lg">
                    <h3 class="title-font text-2xl text-green-800 mb-4">ğŸ® ê²Œì„ ë°©ë²•</h3>
                    <div class="space-y-4">
                        <div class="flex items-start space-x-3">
                            <div class="bg-green-500 text-white rounded-full w-8 h-8 flex items-center justify-center flex-shrink-0 font-bold">1</div>
                            <div>
                                <p class="font-bold text-gray-800">ë‚œì´ë„ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
                                <p class="text-gray-600 text-sm">ì‰¬ì›€(60ì ), ì¤‘ê°„(70ì ), ì–´ë ¤ì›€(80ì )</p>
                            </div>
                        </div>
                        <div class="flex items-start space-x-3">
                            <div class="bg-green-500 text-white rounded-full w-8 h-8 flex items-center justify-center flex-shrink-0 font-bold">2</div>
                            <div>
                                <p class="font-bold text-gray-800">ì œì‹œëœ ë‹¨ì–´ë¥¼ ë³´ì„¸ìš”</p>
                                <p class="text-gray-600 text-sm">ì˜ˆ: "ì»´í“¨í„°"</p>
                            </div>
                        </div>
                        <div class="flex items-start space-x-3">
                            <div class="bg-green-500 text-white rounded-full w-8 h-8 flex items-center justify-center flex-shrink-0 font-bold">3</div>
                            <div>
                                <p class="font-bold text-gray-800">ì˜ë¯¸ê°€ ìœ ì‚¬í•œ ëª…ì‚¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”</p>
                                <p class="text-gray-600 text-sm">ì˜ˆ: "ë…¸íŠ¸ë¶", "í”„ë¡œê·¸ë¨", "í‚¤ë³´ë“œ" ë“±</p>
                            </div>
                        </div>
                        <div class="flex items-start space-x-3">
                            <div class="bg-green-500 text-white rounded-full w-8 h-8 flex items-center justify-center flex-shrink-0 font-bold">4</div>
                            <div>
                                <p class="font-bold text-gray-800">ìœ ì‚¬ë„ê°€ ê¸°ì¤€ ì´ìƒì´ë©´ ì„±ê³µ!</p>
                                <p class="text-gray-600 text-sm">ì…ë ¥í•œ ë‹¨ì–´ê°€ ìƒˆë¡œìš´ ì œì‹œì–´ê°€ ë©ë‹ˆë‹¤</p>
                            </div>
                        </div>
                        <div class="flex items-start space-x-3">
                            <div class="bg-green-500 text-white rounded-full w-8 h-8 flex items-center justify-center flex-shrink-0 font-bold">5</div>
                            <div>
                                <p class="font-bold text-gray-800">ì‹œê°„ ë‚´ì— ìµœëŒ€í•œ ë§ì€ ë‹¨ì–´ë¥¼ ì—°ê²°í•˜ì„¸ìš”</p>
                                <p class="text-gray-600 text-sm">ì—°ì† ì„±ê³µ ì‹œ ì½¤ë³´ ë³´ë„ˆìŠ¤ ì ìˆ˜!</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ì ìˆ˜ ì‹œìŠ¤í…œ -->
                <div class="bg-purple-50 border-l-4 border-purple-500 p-6 rounded-lg">
                    <h3 class="title-font text-2xl text-purple-800 mb-4">ğŸ† ì ìˆ˜ ì‹œìŠ¤í…œ</h3>
                    <ul class="space-y-2 text-gray-700">
                        <li>âœ… <strong>ê¸°ë³¸ ì ìˆ˜</strong>: ìœ ì‚¬ë„ ì ìˆ˜ë§Œí¼ íšë“</li>
                        <li>ğŸ”¥ <strong>ì½¤ë³´ ë³´ë„ˆìŠ¤</strong>: ì—°ì† ì„±ê³µ ì‹œ ì¶”ê°€ ì ìˆ˜ (ì½¤ë³´ x 0.2ë°°)</li>
                        <li>â±ï¸ <strong>ì‹œê°„ ì œí•œ</strong>: 3ë¶„ (180ì´ˆ)</li>
                        <li>âŒ <strong>ì‹¤íŒ¨ ì‹œ</strong>: ì½¤ë³´ê°€ ì´ˆê¸°í™”ë©ë‹ˆë‹¤</li>
                    </ul>
                </div>
            </div>
            
            <div class="p-6 border-t border-gray-200">
                <button onclick="closeInfoModal()" class="w-full bg-gradient-to-r from-blue-500 to-cyan-500 text-white py-3 rounded-xl text-xl title-font hover:shadow-lg transition-all">
                    ì‹œì‘í•˜ê¸°
                </button>
            </div>
        </div>
    </div>
    
    <!-- ê²Œì„ í™”ë©´ -->
    <div id="gameScreen" class="hidden min-h-screen p-4">
        <div class="max-w-7xl mx-auto">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                
                <!-- ì™¼ìª½: ê²Œì„ ì •ë³´ & í†µê³„ -->
                <div class="lg:col-span-1 space-y-4">
                    <!-- íƒ€ì´ë¨¸ -->
                    <div id="timerBox" class="bg-gradient-to-br from-purple-500 to-pink-500 text-white rounded-2xl p-6 text-center shadow-xl">
                        <div class="text-xl opacity-90 mb-2">â±ï¸ ë‚¨ì€ ì‹œê°„</div>
                        <div id="timeLeft" class="text-6xl font-bold title-font">3:00</div>
                    </div>
                    
                    <!-- ì ìˆ˜ & ë‚œì´ë„ -->
                    <div class="bg-white rounded-2xl p-6 shadow-xl">
                        <div class="text-center mb-4">
                            <div class="text-gray-600 text-sm mb-1">í˜„ì¬ ì ìˆ˜</div>
                            <div id="score" class="text-5xl font-bold text-blue-600 title-font">0</div>
                        </div>
                        <div class="border-t pt-4">
                            <div class="text-center text-gray-600 text-sm mb-2">ë‚œì´ë„</div>
                            <div id="difficultyDisplay" class="text-center text-xl font-bold"></div>
                        </div>
                    </div>
                    
                    <!-- ê²Œì„ í†µê³„ -->
                    <div class="bg-white rounded-2xl p-6 shadow-xl">
                        <h3 class="title-font text-xl text-gray-700 mb-4 text-center">ğŸ“Š ê²Œì„ í†µê³„</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">ì—°ê²°ëœ ë‹¨ì–´</span>
                                <span id="totalWords" class="font-bold text-xl text-blue-600">1</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">ìµœëŒ€ ì½¤ë³´</span>
                                <span id="combo" class="font-bold text-xl text-orange-600">0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">í‰ê·  ìœ ì‚¬ë„</span>
                                <span id="avgSimilarity" class="font-bold text-xl text-green-600">-</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-600">ìµœê³  ìœ ì‚¬ë„</span>
                                <span id="highestSimilarity" class="font-bold text-xl text-purple-600">-</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ì¤‘ì•™: ê²Œì„ í”Œë ˆì´ -->
                <div class="lg:col-span-2 space-y-4">
                    <!-- í˜„ì¬ ë‹¨ì–´ -->
                    <div class="bg-white rounded-2xl p-8 shadow-xl text-center">
                        <h2 class="text-gray-600 text-xl mb-4">ğŸ¯ í˜„ì¬ ë‹¨ì–´</h2>
                        <div id="currentWord" class="text-6xl font-bold text-blue-500 title-font mb-6">ì»´í“¨í„°</div>
                        <button onclick="changeWord()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-xl transition-all">
                            ğŸ”„ ë‹¨ì–´ ë³€ê²½
                        </button>
                    </div>
                    
                    <!-- ì…ë ¥ ì˜ì—­ -->
                    <div class="bg-white rounded-2xl p-6 shadow-xl">
                        <div class="flex gap-3 mb-4">
                            <input type="text" id="wordInput" placeholder="ì˜ë¯¸ê°€ ìœ ì‚¬í•œ ëª…ì‚¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."
                                class="flex-1 px-6 py-4 text-xl border-2 border-gray-300 rounded-xl focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all"
                                onkeypress="if(event.key==='Enter') submitWord()">
                            <button id="submitBtn" onclick="submitWord()"
                                class="bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white px-8 py-4 rounded-xl text-xl title-font transition-all transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed">
                                ì œì¶œ
                            </button>
                        </div>
                        
                        <!-- ê²°ê³¼ ë©”ì‹œì§€ -->
                        <div id="result" class="hidden"></div>
                    </div>
                    
                    <!-- ë‹¨ì–´ ì²´ì¸ -->
                    <div class="bg-white rounded-2xl p-6 shadow-xl">
                        <h3 class="title-font text-2xl text-gray-700 mb-4">ğŸ”— ë‹¨ì–´ ì—°ê²° ê¸°ë¡</h3>
                        <div id="wordChain" class="flex flex-wrap gap-2">
                            <!-- ë™ì ìœ¼ë¡œ ì¶”ê°€ë¨ -->
                        </div>
                    </div>
                    
                    <!-- ì‹¤ì‹œê°„ ë¦¬ë”ë³´ë“œ -->
                    <div class="bg-white rounded-2xl p-6 shadow-xl">
                        <h3 class="title-font text-2xl text-gray-700 mb-4">ğŸ† ì‹¤ì‹œê°„ ë¦¬ë”ë³´ë“œ</h3>
                        <div id="leaderboard" class="space-y-2">
                            <div class="text-center text-gray-400 py-8">ë¦¬ë”ë³´ë“œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ê²Œì„ ì¢…ë£Œ ëª¨ë‹¬ -->
    <div id="gameOverModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4 overflow-y-auto">
        <div class="bg-white rounded-3xl shadow-2xl max-w-4xl w-full p-8 my-8">
            <h2 class="title-font text-4xl text-center text-gray-800 mb-6">ğŸ® ê²Œì„ ì¢…ë£Œ!</h2>
            
            <div class="grid grid-cols-2 gap-4 mb-6">
                <div class="bg-blue-50 p-6 rounded-xl text-center">
                    <div class="text-gray-600 mb-2">ìµœì¢… ì ìˆ˜</div>
                    <div id="finalScore" class="text-4xl font-bold text-blue-600 title-font">0</div>
                </div>
                <div class="bg-green-50 p-6 rounded-xl text-center">
                    <div class="text-gray-600 mb-2">ì—°ê²° ë‹¨ì–´</div>
                    <div id="finalWords" class="text-4xl font-bold text-green-600 title-font">0</div>
                </div>
                <div class="bg-purple-50 p-6 rounded-xl text-center">
                    <div class="text-gray-600 mb-2">í‰ê·  ìœ ì‚¬ë„</div>
                    <div id="finalAvgSimilarity" class="text-4xl font-bold text-purple-600 title-font">0ì </div>
                </div>
                <div class="bg-orange-50 p-6 rounded-xl text-center">
                    <div class="text-gray-600 mb-2">ìµœëŒ€ ì½¤ë³´</div>
                    <div id="finalCombo" class="text-4xl font-bold text-orange-600 title-font">0</div>
                </div>
            </div>
            
            <!-- ì˜ˆìƒ ìˆœìœ„ í‘œì‹œ -->
            <div id="rankPreview" class="mb-6 p-4 rounded-xl bg-gradient-to-r from-yellow-50 to-orange-50 border-2 border-yellow-300">
                <div class="text-center">
                    <div class="text-gray-700 mb-2">ğŸ† í˜„ì¬ ë¦¬ë”ë³´ë“œ ê¸°ì¤€ ì˜ˆìƒ ìˆœìœ„</div>
                    <div id="estimatedRank" class="text-3xl font-bold text-orange-600 title-font">ê³„ì‚° ì¤‘...</div>
                </div>
            </div>
            
            <!-- ì´ë¦„ ì…ë ¥ -->
            <div class="mb-6">
                <label class="block text-gray-700 mb-2 font-bold">ì´ë¦„ ì…ë ¥ (ë¦¬ë”ë³´ë“œ ë“±ë¡)</label>
                <input type="text" id="playerName" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" maxlength="20"
                    class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:border-blue-500"
                    onkeypress="if(event.key==='Enter') submitScore()">
            </div>
            
            <!-- í˜„ì¬ ë¦¬ë”ë³´ë“œ ë¯¸ë¦¬ë³´ê¸° -->
            <div class="mb-6">
                <h3 class="title-font text-xl text-gray-700 mb-3 text-center">ğŸ“Š í˜„ì¬ ë¦¬ë”ë³´ë“œ TOP 5</h3>
                <div id="modalLeaderboard" class="space-y-2 max-h-64 overflow-y-auto">
                    <div class="text-center text-gray-400 py-4">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
                </div>
            </div>
            
            <div class="flex gap-4">
                <button onclick="submitScore()" id="submitScoreBtn"
                    class="flex-1 bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600 text-white py-4 rounded-xl text-xl title-font transition-all transform hover:scale-105">
                    ì ìˆ˜ ë“±ë¡í•˜ê¸°
                </button>
                <button onclick="newGame()" 
                    class="flex-1 bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white py-4 rounded-xl text-xl title-font transition-all transform hover:scale-105">
                    ë‹¤ì‹œ í•˜ê¸°
                </button>
            </div>
        </div>
    </div>

    <script>
        // =============================================
        // Firebase ì„¤ì •
        // =============================================
        
        // Firebase ì„¤ì •
        const firebaseConfig = {
            apiKey: "AIzaSyDBiRa5pcNHGs2V0iUvVfXbIP72P5kHwlI",
            authDomain: "eduapp-af605.firebaseapp.com",
            databaseURL: "https://eduapp-af605-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "eduapp-af605",
            storageBucket: "eduapp-af605.firebasestorage.app",
            messagingSenderId: "761453729680",
            appId: "1:761453729680:web:12b25c7b49b55e07d80515"
        };
        
        let firebaseInitialized = false;
        let database = null;
        
        // Firebase ì´ˆê¸°í™”
        try {
            firebase.initializeApp(firebaseConfig);
            database = firebase.database();
            firebaseInitialized = true;
            console.log('âœ… Firebase ì—°ê²° ì„±ê³µ!');
        } catch (error) {
            console.error('âŒ Firebase ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
            alert('Firebase ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë¦¬ë”ë³´ë“œ ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë©ë‹ˆë‹¤.');
        }
        
        // =============================================
        // Cloudflare Worker ì„¤ì •
        // =============================================
        
        const WORKER_URL = 'https://your-worker.workers.dev';
        
        // =============================================
        // ê²Œì„ ìƒíƒœ
        // =============================================
        
        const DIFFICULTIES = {
            easy: { threshold: 0.60, label: 'ì‰¬ì›€ (60ì )', color: 'green', emoji: 'ğŸ˜Š' },
            medium: { threshold: 0.70, label: 'ì¤‘ê°„ (70ì )', color: 'yellow', emoji: 'ğŸ¤”' },
            hard: { threshold: 0.80, label: 'ì–´ë ¤ì›€ (80ì )', color: 'red', emoji: 'ğŸ”¥' }
        };
        
        let selectedDifficulty = null;
        let SIMILARITY_THRESHOLD = 0.70;
        const COMBO_MULTIPLIER = 0.2;
        const GAME_TIME = 180; // 3ë¶„
        
        let gameState = {
            currentWord: '',
            score: 0,
            combo: 0,
            maxCombo: 0,
            usedWords: new Set(),
            wordChain: [],
            similarities: [],
            timeLeft: GAME_TIME
        };
        
        let isGameActive = false;
        let isProcessing = false;
        let timerInterval = null;
        let resultTimeout = null;
        
        // =============================================
        // UI í•¨ìˆ˜ë“¤
        // =============================================
        
        function showInfoModal() {
            document.getElementById('infoModal').classList.remove('hidden');
            document.getElementById('infoModal').classList.add('flex');
        }
        
        function closeInfoModal(event) {
            if (event && event.target !== event.currentTarget) return;
            document.getElementById('infoModal').classList.add('hidden');
            document.getElementById('infoModal').classList.remove('flex');
        }
        
        function selectDifficulty(level) {
            selectedDifficulty = level;
            SIMILARITY_THRESHOLD = DIFFICULTIES[level].threshold;
            
            // ëª¨ë“  ë²„íŠ¼ ì´ˆê¸°í™”
            document.querySelectorAll('.difficulty-btn').forEach(btn => {
                btn.classList.remove('ring-4', 'ring-offset-2');
            });
            
            // ì„ íƒëœ ë²„íŠ¼ ê°•ì¡°
            const btn = document.getElementById('diff' + level.charAt(0).toUpperCase() + level.slice(1));
            btn.classList.add('ring-4', 'ring-offset-2');
            
            if (level === 'easy') btn.classList.add('ring-green-500');
            else if (level === 'medium') btn.classList.add('ring-yellow-500');
            else btn.classList.add('ring-red-500');
            
            // ì‹œì‘ ë²„íŠ¼ í™œì„±í™”
            document.getElementById('startBtn').disabled = false;
        }
        
        function startGame() {
            if (!selectedDifficulty) {
                alert('ë‚œì´ë„ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”!');
                return;
            }
            
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            
            initGame();
        }
        
        function initGame() {
            const startWords = ['ì»´í“¨í„°', 'ì‚¬ê³¼', 'ë‚˜ë¬´', 'ë°”ë‹¤', 'í•˜ëŠ˜', 'ê½ƒ', 'ìŒì•…', 'ì±…'];
            const startWord = startWords[Math.floor(Math.random() * startWords.length)];
            
            gameState = {
                currentWord: startWord,
                score: 0,
                combo: 0,
                maxCombo: 0,
                usedWords: new Set([startWord]),
                wordChain: [{word: startWord, similarity: null}],
                similarities: [],
                timeLeft: GAME_TIME
            };
            
            isGameActive = true;
            isProcessing = false;
            
            document.getElementById('wordInput').disabled = false;
            document.getElementById('submitBtn').disabled = false;
            document.getElementById('wordInput').value = '';
            document.getElementById('wordInput').focus();
            
            // ë‚œì´ë„ í‘œì‹œ
            const diff = DIFFICULTIES[selectedDifficulty];
            document.getElementById('difficultyDisplay').innerHTML = 
                `<span class="text-${diff.color}-600">${diff.emoji} ${diff.label}</span>`;
            
            updateDisplay();
            startTimer();
            loadLeaderboard();
            
            document.getElementById('result').style.display = 'none';
        }
        
        // =============================================
        // ì½”ì‚¬ì¸ ìœ ì‚¬ë„ API í˜¸ì¶œ
        // =============================================
        
        async function getSimilarity(word1, word2) {
            try {
                const response = await fetch(WORKER_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ word1, word2 })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                return data;
            } catch (error) {
                console.error('API í˜¸ì¶œ ì‹¤íŒ¨:', error);
                throw new Error('ìœ ì‚¬ë„ ê³„ì‚° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // =============================================
        // ê²Œì„ ë¡œì§
        // =============================================
        
        function startTimer() {
            const timerBox = document.getElementById('timerBox');
            timerBox.classList.remove('animate-pulse-custom');
            
            timerInterval = setInterval(() => {
                gameState.timeLeft--;
                
                const minutes = Math.floor(gameState.timeLeft / 60);
                const seconds = gameState.timeLeft % 60;
                document.getElementById('timeLeft').textContent = 
                    `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                if (gameState.timeLeft === 30) {
                    timerBox.classList.add('animate-pulse-custom');
                    timerBox.classList.remove('from-purple-500', 'to-pink-500');
                    timerBox.classList.add('from-red-500', 'to-orange-500');
                }
                
                if (gameState.timeLeft <= 0) {
                    clearInterval(timerInterval);
                    endGame();
                }
            }, 1000);
        }
        
        async function submitWord() {
            if (!isGameActive || isProcessing) return;
            
            const input = document.getElementById('wordInput');
            const word = input.value.trim();
            
            if (!word) {
                showResult('ë‹¨ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!', false);
                return;
            }
            
            if (gameState.usedWords.has(word)) {
                showResult('ì´ë¯¸ ì‚¬ìš©í•œ ë‹¨ì–´ì…ë‹ˆë‹¤!', false);
                return;
            }
            
            isProcessing = true;
            document.getElementById('submitBtn').disabled = true;
            showResult('ğŸ¤– AIê°€ ìœ ì‚¬ë„ë¥¼ ê³„ì‚°í•˜ëŠ” ì¤‘...<div class="loading ml-2"></div>', true);
            
            try {
                const result = await getSimilarity(gameState.currentWord, word);
                
                if (!result.isNoun) {
                    showResult('âŒ ' + (result.message || 'ëª…ì‚¬ë§Œ ì…ë ¥í•´ì£¼ì„¸ìš”!'), false);
                    isProcessing = false;
                    document.getElementById('submitBtn').disabled = false;
                    return;
                }
                
                const similarity = result.similarity;
                const similarityPercent = similarity * 100;
                
                if (similarity >= SIMILARITY_THRESHOLD) {
                    // ì„±ê³µ
                    const baseScore = Math.floor(similarityPercent);
                    const comboBonus = Math.floor(baseScore * gameState.combo * COMBO_MULTIPLIER);
                    const totalScore = baseScore + comboBonus;
                    
                    gameState.score += totalScore;
                    gameState.combo++;
                    
                    if (gameState.combo > gameState.maxCombo) {
                        gameState.maxCombo = gameState.combo;
                    }
                    
                    gameState.usedWords.add(word);
                    gameState.currentWord = word;
                    gameState.wordChain.push({word, similarity});
                    gameState.similarities.push(similarity);
                    
                    let qualityLabel = '';
                    if (similarityPercent >= 80) qualityLabel = 'ğŸ”¥ ì™„ë²½! ';
                    else if (similarityPercent >= 70) qualityLabel = 'ğŸ‘ í›Œë¥­í•´ìš”! ';
                    else if (similarityPercent >= 60) qualityLabel = 'âœ¨ ì¢‹ì•„ìš”! ';
                    else qualityLabel = 'âœ… í†µê³¼! ';
                    
                    showResult(
                        qualityLabel + `ìœ ì‚¬ë„ ${similarityPercent.toFixed(1)}ì  (+${totalScore}ì )` +
                        (comboBonus > 0 ? ` [ì½¤ë³´ x${gameState.combo}]` : ''),
                        true,
                        similarity
                    );
                    
                    updateDisplay();
                    input.value = '';
                    
                } else {
                    // ì‹¤íŒ¨
                    showResult(
                        `âŒ ìœ ì‚¬ë„ê°€ ë„ˆë¬´ ë‚®ìŠµë‹ˆë‹¤! (${similarityPercent.toFixed(1)}ì  < ${SIMILARITY_THRESHOLD * 100}ì )`,
                        false
                    );
                    gameState.combo = 0;
                    updateDisplay();
                    input.value = '';
                }
                
            } catch (error) {
                console.error('Error:', error);
                showResult('ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message, false);
            } finally {
                isProcessing = false;
                document.getElementById('submitBtn').disabled = false;
                document.getElementById('wordInput').focus();
            }
        }
        
        function showResult(message, isSuccess, similarity = null) {
            const resultDiv = document.getElementById('result');
            
            if (resultTimeout) {
                clearTimeout(resultTimeout);
                resultTimeout = null;
            }
            
            resultDiv.className = 'p-4 rounded-xl text-center text-lg font-bold animate-slideDown ' + 
                (isSuccess ? 'bg-green-100 text-green-800 border-2 border-green-300' : 'bg-red-100 text-red-800 border-2 border-red-300');
            
            if (isSuccess && similarity !== null) {
                resultDiv.innerHTML = `
                    ${message}
                    <div class="text-3xl mt-2">${(similarity * 100).toFixed(1)}%</div>
                `;
            } else {
                resultDiv.innerHTML = message;
            }
            
            resultDiv.style.display = 'block';
            
            resultTimeout = setTimeout(() => {
                resultDiv.style.display = 'none';
                resultTimeout = null;
            }, 2000);
        }
        
        function updateDisplay() {
            document.getElementById('currentWord').textContent = gameState.currentWord;
            document.getElementById('score').textContent = gameState.score;
            
            const chainDiv = document.getElementById('wordChain');
            chainDiv.innerHTML = '';
            
            gameState.wordChain.forEach((item, index) => {
                const badge = document.createElement('span');
                badge.className = 'inline-block px-4 py-2 rounded-lg text-sm font-bold';
                
                if (index === 0) {
                    badge.className += ' bg-purple-100 text-purple-700 border-2 border-purple-300';
                    badge.textContent = `${item.word} (ì‹œì‘)`;
                } else {
                    const score = (item.similarity * 100).toFixed(0);
                    if (item.similarity >= 0.8) {
                        badge.className += ' bg-red-100 text-red-700 border-2 border-red-300';
                    } else if (item.similarity >= 0.7) {
                        badge.className += ' bg-orange-100 text-orange-700 border-2 border-orange-300';
                    } else {
                        badge.className += ' bg-green-100 text-green-700 border-2 border-green-300';
                    }
                    badge.textContent = `${item.word} (${score}ì )`;
                }
                
                chainDiv.appendChild(badge);
            });
            
            document.getElementById('totalWords').textContent = gameState.wordChain.length;
            document.getElementById('combo').textContent = gameState.maxCombo;
            
            if (gameState.similarities.length > 0) {
                const avg = gameState.similarities.reduce((a, b) => a + b) / gameState.similarities.length;
                const max = Math.max(...gameState.similarities);
                
                document.getElementById('avgSimilarity').textContent = 
                    (avg * 100).toFixed(0) + 'ì ';
                document.getElementById('highestSimilarity').textContent = 
                    (max * 100).toFixed(0) + 'ì ';
            }
        }
        
        function changeWord() {
            if (!isGameActive) return;
            
            const newWords = ['ì»´í“¨í„°', 'ì‚¬ê³¼', 'ë‚˜ë¬´', 'ë°”ë‹¤', 'í•˜ëŠ˜', 'ê½ƒ', 'ìŒì•…', 'ì±…', 'í•™êµ', 'ì¹œêµ¬'];
            const availableWords = newWords.filter(w => !gameState.usedWords.has(w));
            
            if (availableWords.length === 0) {
                showResult('ë” ì´ìƒ ë³€ê²½í•  ë‹¨ì–´ê°€ ì—†ìŠµë‹ˆë‹¤!', false);
                return;
            }
            
            const newWord = availableWords[Math.floor(Math.random() * availableWords.length)];
            gameState.currentWord = newWord;
            gameState.usedWords.add(newWord);
            gameState.wordChain.push({word: newWord, similarity: null});
            gameState.combo = 0;
            
            showResult(`ìƒˆë¡œìš´ ë‹¨ì–´ë¡œ ë³€ê²½: "${newWord}"`, true);
            updateDisplay();
        }
        
        function endGame() {
            isGameActive = false;
            clearInterval(timerInterval);
            
            document.getElementById('wordInput').disabled = true;
            document.getElementById('submitBtn').disabled = true;
            
            const avgSimilarity = gameState.similarities.length > 0 
                ? (gameState.similarities.reduce((a, b) => a + b) / gameState.similarities.length * 100).toFixed(0)
                : 0;
            
            document.getElementById('finalScore').textContent = gameState.score;
            document.getElementById('finalWords').textContent = gameState.wordChain.length;
            document.getElementById('finalAvgSimilarity').textContent = avgSimilarity + 'ì ';
            document.getElementById('finalCombo').textContent = gameState.maxCombo;
            
            // ëª¨ë‹¬ ë¦¬ë”ë³´ë“œ ë¡œë“œ ë° ì˜ˆìƒ ìˆœìœ„ ê³„ì‚°
            loadModalLeaderboard();
            
            document.getElementById('gameOverModal').classList.remove('hidden');
            document.getElementById('gameOverModal').classList.add('flex');
            
            // ì´ë¦„ ì…ë ¥ë€ì— í¬ì»¤ìŠ¤
            setTimeout(() => {
                document.getElementById('playerName').focus();
            }, 300);
        }
        
        function newGame() {
            document.getElementById('gameOverModal').classList.add('hidden');
            document.getElementById('gameOverModal').classList.remove('flex');
            
            // íƒ€ì´ë¨¸ ë°•ìŠ¤ ì´ˆê¸°í™”
            const timerBox = document.getElementById('timerBox');
            timerBox.classList.remove('animate-pulse-custom', 'from-red-500', 'to-orange-500');
            timerBox.classList.add('from-purple-500', 'to-pink-500');
            
            initGame();
        }
        
        // =============================================
        // Firebase ë¦¬ë”ë³´ë“œ
        // =============================================
        
        function loadLeaderboard() {
            if (!firebaseInitialized) {
                document.getElementById('leaderboard').innerHTML = `
                    <div class="text-center text-gray-400 py-8">
                        <p>ğŸ”¥ Firebase ì„¤ì •ì´ í•„ìš”í•©ë‹ˆë‹¤</p>
                        <p class="text-sm mt-2">ì‹¤ì‹œê°„ ë¦¬ë”ë³´ë“œë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ Firebaseë¥¼ ì„¤ì •í•˜ì„¸ìš”</p>
                    </div>
                `;
                return;
            }
            
            const difficulty = selectedDifficulty;
            const leaderboardRef = database.ref(`leaderboard/${difficulty}`);
            
            leaderboardRef.orderByChild('score').limitToLast(10).on('value', (snapshot) => {
                const leaderboardDiv = document.getElementById('leaderboard');
                leaderboardDiv.innerHTML = '';
                
                const scores = [];
                snapshot.forEach((child) => {
                    scores.push({...child.val(), key: child.key});
                });
                
                scores.reverse(); // ë†’ì€ ì ìˆ˜ë¶€í„°
                
                if (scores.length === 0) {
                    leaderboardDiv.innerHTML = '<div class="text-center text-gray-400 py-4">ì•„ì§ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤</div>';
                    return;
                }
                
                scores.forEach((score, index) => {
                    const item = document.createElement('div');
                    item.className = 'flex items-center justify-between p-3 rounded-lg ' + 
                        (index < 3 ? 'bg-gradient-to-r from-yellow-50 to-orange-50 border-2 border-yellow-300' : 'bg-gray-50');
                    
                    let medal = '';
                    if (index === 0) medal = 'ğŸ¥‡';
                    else if (index === 1) medal = 'ğŸ¥ˆ';
                    else if (index === 2) medal = 'ğŸ¥‰';
                    else medal = `${index + 1}ìœ„`;
                    
                    item.innerHTML = `
                        <div class="flex items-center space-x-3">
                            <span class="text-2xl font-bold">${medal}</span>
                            <div>
                                <div class="font-bold">${score.name}</div>
                                <div class="text-xs text-gray-500">${score.words}ê°œ ë‹¨ì–´ â€¢ ${score.avgSimilarity}</div>
                            </div>
                        </div>
                        <div class="text-2xl font-bold text-blue-600">${score.score}ì </div>
                    `;
                    
                    leaderboardDiv.appendChild(item);
                });
            });
        }
        
        function loadModalLeaderboard() {
            const modalLeaderboardDiv = document.getElementById('modalLeaderboard');
            const estimatedRankDiv = document.getElementById('estimatedRank');
            
            if (!firebaseInitialized) {
                modalLeaderboardDiv.innerHTML = '<div class="text-center text-gray-400 py-4">Firebase ë¯¸ì„¤ì •</div>';
                estimatedRankDiv.textContent = '-';
                return;
            }
            
            const difficulty = selectedDifficulty;
            const leaderboardRef = database.ref(`leaderboard/${difficulty}`);
            
            leaderboardRef.orderByChild('score').once('value', (snapshot) => {
                const scores = [];
                snapshot.forEach((child) => {
                    scores.push({...child.val(), key: child.key});
                });
                
                scores.reverse(); // ë†’ì€ ì ìˆ˜ë¶€í„°
                
                // ì˜ˆìƒ ìˆœìœ„ ê³„ì‚°
                let estimatedRank = 1;
                for (let i = 0; i < scores.length; i++) {
                    if (gameState.score > scores[i].score) {
                        estimatedRank = i + 1;
                        break;
                    }
                    estimatedRank = i + 2;
                }
                
                // ìˆœìœ„ í‘œì‹œ
                let rankText = `${estimatedRank}ìœ„`;
                let rankEmoji = '';
                if (estimatedRank === 1) {
                    rankText = 'ğŸ¥‡ 1ìœ„!';
                    rankEmoji = 'ğŸ‘‘';
                } else if (estimatedRank === 2) {
                    rankText = 'ğŸ¥ˆ 2ìœ„!';
                    rankEmoji = 'âœ¨';
                } else if (estimatedRank === 3) {
                    rankText = 'ğŸ¥‰ 3ìœ„!';
                    rankEmoji = 'ğŸ‰';
                } else if (estimatedRank <= 10) {
                    rankText = `ğŸ† ${estimatedRank}ìœ„`;
                }
                
                estimatedRankDiv.innerHTML = `${rankEmoji} ${rankText}`;
                
                // TOP 5ë§Œ í‘œì‹œ
                modalLeaderboardDiv.innerHTML = '';
                
                if (scores.length === 0) {
                    modalLeaderboardDiv.innerHTML = '<div class="text-center text-gray-400 py-4">ì²« ë²ˆì§¸ ê¸°ë¡ì´ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤!</div>';
                    return;
                }
                
                const top5 = scores.slice(0, 5);
                top5.forEach((score, index) => {
                    const item = document.createElement('div');
                    
                    // ì‚¬ìš©ì ì ìˆ˜ë³´ë‹¤ ë‚®ìœ¼ë©´ íë¦¬ê²Œ
                    const isBeaten = gameState.score > score.score;
                    
                    item.className = 'flex items-center justify-between p-3 rounded-lg transition-all ' + 
                        (isBeaten ? 'bg-gray-100 opacity-50' : 
                         index < 3 ? 'bg-gradient-to-r from-yellow-50 to-orange-50 border-2 border-yellow-300' : 'bg-gray-50');
                    
                    let medal = '';
                    if (index === 0) medal = 'ğŸ¥‡';
                    else if (index === 1) medal = 'ğŸ¥ˆ';
                    else if (index === 2) medal = 'ğŸ¥‰';
                    else medal = `${index + 1}ìœ„`;
                    
                    item.innerHTML = `
                        <div class="flex items-center space-x-3">
                            <span class="text-xl font-bold">${medal}</span>
                            <div>
                                <div class="font-bold ${isBeaten ? 'line-through' : ''}">${score.name}</div>
                                <div class="text-xs text-gray-500">${score.words}ê°œ ë‹¨ì–´ â€¢ ${score.avgSimilarity}</div>
                            </div>
                        </div>
                        <div class="text-xl font-bold ${isBeaten ? 'text-gray-400' : 'text-blue-600'}">${score.score}ì </div>
                    `;
                    
                    modalLeaderboardDiv.appendChild(item);
                });
                
                // ë‚´ ì ìˆ˜ ìœ„ì¹˜ í‘œì‹œ (TOP 5 ë°–ì´ë©´)
                if (estimatedRank > 5) {
                    const myItem = document.createElement('div');
                    myItem.className = 'flex items-center justify-between p-3 rounded-lg bg-blue-100 border-2 border-blue-400 mt-2';
                    myItem.innerHTML = `
                        <div class="flex items-center space-x-3">
                            <span class="text-xl font-bold">${estimatedRank}ìœ„</span>
                            <div>
                                <div class="font-bold text-blue-700">â† ë‚´ ì˜ˆìƒ ìˆœìœ„</div>
                            </div>
                        </div>
                        <div class="text-xl font-bold text-blue-600">${gameState.score}ì </div>
                    `;
                    modalLeaderboardDiv.appendChild(myItem);
                }
            });
        }
        
        let myScoreKey = null; // ë“±ë¡í•œ ì ìˆ˜ì˜ í‚¤ ì €ì¥
        
        function submitScore() {
            const playerName = document.getElementById('playerName').value.trim();
            
            if (!playerName) {
                alert('ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                return;
            }
            
            // íŠ¹ìˆ˜ë¬¸ì ê²€ì¦ (<> ê¸ˆì§€)
            if (playerName.includes('<') || playerName.includes('>')) {
                alert('ì´ë¦„ì— < ë˜ëŠ” > ê¸°í˜¸ëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            if (!firebaseInitialized) {
                alert('Firebaseê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.\nì ìˆ˜ëŠ” ì €ì¥ë˜ì§€ ì•Šì§€ë§Œ ë‹¤ì‹œ ê²Œì„ì„ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                newGame();
                return;
            }
            
            const avgSimilarity = gameState.similarities.length > 0 
                ? (gameState.similarities.reduce((a, b) => a + b) / gameState.similarities.length * 100).toFixed(0)
                : 0;
            
            const scoreData = {
                name: playerName,
                score: gameState.score,
                words: gameState.wordChain.length,
                avgSimilarity: avgSimilarity + 'ì ',
                maxCombo: gameState.maxCombo,
                difficulty: selectedDifficulty,
                timestamp: firebase.database.ServerValue.TIMESTAMP
            };
            
            // ë²„íŠ¼ ë¹„í™œì„±í™”
            const submitBtn = document.getElementById('submitScoreBtn');
            submitBtn.disabled = true;
            submitBtn.textContent = 'ë“±ë¡ ì¤‘...';
            
            const leaderboardRef = database.ref(`leaderboard/${selectedDifficulty}`);
            const newScoreRef = leaderboardRef.push();
            myScoreKey = newScoreRef.key;
            
            newScoreRef.set(scoreData)
                .then(() => {
                    submitBtn.textContent = 'âœ… ë“±ë¡ ì™„ë£Œ!';
                    submitBtn.classList.remove('from-purple-500', 'to-pink-500');
                    submitBtn.classList.add('from-green-500', 'to-green-600');
                    
                    // ë¦¬ë”ë³´ë“œ ì¦‰ì‹œ ê°±ì‹ 
                    loadModalLeaderboard();
                    
                    // ì•Œë¦¼
                    setTimeout(() => {
                        alert('ì ìˆ˜ê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‰\në¦¬ë”ë³´ë“œë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!');
                    }, 500);
                })
                .catch((error) => {
                    console.error('ì ìˆ˜ ë“±ë¡ ì‹¤íŒ¨:', error);
                    alert('ì ìˆ˜ ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤: ' + error.message);
                    submitBtn.disabled = false;
                    submitBtn.textContent = 'ì ìˆ˜ ë“±ë¡í•˜ê¸°';
                });
        }
        
        // =============================================
        // ì´ˆê¸°í™”
        // =============================================
        
        document.addEventListener('DOMContentLoaded', () => {
            // Worker URL ì²´í¬
            if (WORKER_URL === 'https://your-worker.workers.dev') {
                console.warn('âš ï¸ Cloudflare Worker URLì„ ì„¤ì •í•´ì£¼ì„¸ìš”!');
            }
        });
    </script>
</body>
</html>
