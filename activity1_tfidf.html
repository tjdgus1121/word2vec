<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TF-IDF ê³„ì‚° ì²´í—˜ (í˜•íƒœì†Œ ë¶„ì„)</title>
    <link href="https://cdn.jsdelivr.net/npm/pretendard@1.3.9/dist/web/variable/pretendardvariable.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <style>
        :root {
            --primary: #4F46E5;
            --primary-light: #818CF8;
            --primary-dark: #3730A3;
            --bg: #F8FAFC;
            --card: #FFFFFF;
            --text: #1E293B;
            --text-light: #64748B;
            --border: #E2E8F0;
            --success: #10B981;
            --warning: #F59E0B;
            --danger: #EF4444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Pretendard Variable', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            padding: 24px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 32px;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 8px;
        }

        .subtitle {
            color: var(--text-light);
            font-size: 1.1rem;
        }

        .card {
            background: var(--card);
            border-radius: 16px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
            border: 1px solid var(--border);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-title .icon {
            font-size: 1.5rem;
        }

        /* ë¡œë”© ì˜¤ë²„ë ˆì´ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .loading-overlay.hidden {
            display: none;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 1.2rem;
            color: var(--text);
            font-weight: 600;
        }

        .loading-subtext {
            font-size: 0.95rem;
            color: var(--text-light);
            margin-top: 8px;
        }

        /* ì„¤ì • ì˜ì—­ */
        .settings {
            display: flex;
            gap: 24px;
            flex-wrap: wrap;
            align-items: center;
        }

        .checkbox-wrapper {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .checkbox-wrapper input[type="checkbox"] {
            width: 20px;
            height: 20px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        .checkbox-label {
            font-size: 0.95rem;
            color: var(--text);
            user-select: none;
        }

        /* ë¬¸ì„œ ì…ë ¥ ì˜ì—­ */
        .documents-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .document-row {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .document-label {
            min-width: 70px;
            font-weight: 600;
            color: var(--primary);
            font-size: 0.95rem;
        }

        .document-input {
            flex: 1;
            padding: 14px 18px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.2s ease;
        }

        .document-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.1);
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: inherit;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--bg);
            color: var(--text);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover:not(:disabled) {
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn-danger {
            background: transparent;
            color: var(--danger);
            padding: 8px 12px;
        }

        .btn-danger:hover {
            background: rgba(239, 68, 68, 0.1);
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 0.85rem;
        }

        .button-group {
            display: flex;
            gap: 12px;
            margin-top: 16px;
            flex-wrap: wrap;
        }

        /* í’ˆì‚¬ íƒœê·¸ ì„ íƒ */
        .pos-tags-section {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--border);
        }

        .pos-tags-title {
            font-weight: 600;
            color: var(--text);
            font-size: 0.95rem;
            margin-bottom: 12px;
        }

        .pos-tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .pos-tag-btn {
            padding: 8px 14px;
            border: 2px solid var(--border);
            border-radius: 20px;
            background: white;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: inherit;
        }

        .pos-tag-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .pos-tag-btn:hover:not(.active) {
            border-color: var(--primary);
            color: var(--primary);
        }

        .pos-tag-wrapper {
            display: inline-flex;
            align-items: stretch;
            border: 2px solid var(--border);
            border-radius: 20px;
            overflow: hidden;
            transition: all 0.2s ease;
        }

        .pos-tag-wrapper:hover {
            border-color: var(--primary);
            box-shadow: 0 2px 8px rgba(79, 70, 229, 0.15);
        }

        .pos-tag-wrapper .pos-tag-btn {
            border: none;
            border-radius: 0;
            margin: 0;
            border-right: 1px solid var(--border);
        }

        .pos-tag-wrapper.active-wrapper {
            border-color: var(--primary);
            background: var(--primary);
        }

        .pos-tag-wrapper.active-wrapper .pos-tag-btn {
            background: var(--primary);
            color: white;
            border-right-color: rgba(255, 255, 255, 0.3);
        }

        .pos-info-icon {
            cursor: pointer;
            font-size: 1.1rem;
            padding: 8px 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            transition: all 0.2s ease;
            min-width: 36px;
        }

        .pos-info-icon:hover {
            background: #F0F9FF;
            transform: scale(1.05);
        }

        .pos-tag-wrapper.active-wrapper .pos-info-icon {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .pos-tag-wrapper.active-wrapper .pos-info-icon:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* íŒì—… ëª¨ë‹¬ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            animation: fadeIn 0.2s ease;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 32px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 2px solid var(--border);
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .modal-close {
            cursor: pointer;
            font-size: 1.5rem;
            color: var(--text-light);
            background: none;
            border: none;
            padding: 4px 8px;
            transition: all 0.2s ease;
        }

        .modal-close:hover {
            color: var(--danger);
            transform: scale(1.1);
        }

        .modal-body {
            color: var(--text);
            line-height: 1.8;
        }

        .modal-section {
            margin-bottom: 20px;
        }

        .modal-section-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 8px;
        }

        .modal-examples {
            background: var(--bg);
            padding: 12px;
            border-radius: 8px;
            font-size: 0.95rem;
        }

        .modal-example-item {
            padding: 4px 0;
        }

        /* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */
        .tabs {
            display: flex;
            gap: 4px;
            background: var(--bg);
            padding: 6px;
            border-radius: 14px;
            margin-bottom: 24px;
        }

        .tab {
            flex: 1;
            padding: 14px 20px;
            border: none;
            background: transparent;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: inherit;
            color: var(--text-light);
        }

        .tab:hover {
            color: var(--text);
            background: rgba(255, 255, 255, 0.5);
        }

        .tab.active {
            background: var(--card);
            color: var(--primary);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        /* ìˆ˜ì‹ ì˜ì—­ */
        .formula-box {
            background: linear-gradient(135deg, #F0F9FF, #E0F2FE);
            border: 2px solid #BAE6FD;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 24px;
            text-align: center;
        }

        .formula-title {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 12px;
            font-weight: 600;
        }

        .formula {
            font-size: 1.3rem;
        }

        /* í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .table-container {
            overflow-x: auto;
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95rem;
        }

        th, td {
            padding: 14px 18px;
            text-align: center;
            border-bottom: 1px solid var(--border);
            border-right: 1px solid var(--border);
        }

        th:last-child, td:last-child {
            border-right: none;
        }

        th {
            background: var(--bg);
            font-weight: 700;
            color: var(--text);
            position: sticky;
            top: 0;
        }

        th:first-child {
            text-align: left;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
        }

        td:first-child {
            text-align: left;
            font-weight: 600;
            background: #F8FAFC;
            color: var(--primary);
        }

        tr:hover td {
            background: #F1F5F9;
        }

        tr:hover td:first-child {
            background: #EEF2FF;
        }

        /* íˆíŠ¸ë§µ ìƒ‰ìƒ */
        .heat-0 { background: #FEF2F2 !important; }
        .heat-1 { background: #FEE2E2 !important; }
        .heat-2 { background: #FECACA !important; }
        .heat-3 { background: #FCA5A5 !important; }
        .heat-4 { background: #F87171 !important; }
        .heat-5 { background: #EF4444 !important; color: white; }
        .heat-6 { background: #DC2626 !important; color: white; }
        .heat-7 { background: #B91C1C !important; color: white; }
        .heat-8 { background: #991B1B !important; color: white; }
        .heat-9 { background: #7F1D1D !important; color: white; }

        /* íƒ­ ì½˜í…ì¸  */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* DF/IDF íŠ¹ë³„ í…Œì´ë¸” */
        .df-row {
            background: linear-gradient(135deg, #ECFDF5, #D1FAE5) !important;
        }

        .idf-row {
            background: linear-gradient(135deg, #FEF3C7, #FDE68A) !important;
        }

        /* ì„¤ëª… í…ìŠ¤íŠ¸ */
        .description {
            color: var(--text-light);
            font-size: 0.95rem;
            line-height: 1.7;
            margin-bottom: 20px;
            padding: 16px;
            background: #F8FAFC;
            border-radius: 10px;
            border-left: 4px solid var(--primary);
        }

        /* ë‹¨ì–´ í´ë¦­ íš¨ê³¼ */
        .clickable-word {
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .clickable-word:hover {
            color: var(--primary);
            text-decoration: underline;
        }

        .selected-word {
            background: #C7D2FE !important;
            font-weight: 700;
        }

        /* ë²”ë¡€ */
        .legend {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 16px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        /* í† í°í™” ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸° */
        .preview-section {
            margin-top: 16px;
            padding: 16px;
            background: linear-gradient(135deg, #F0FDF4, #DCFCE7);
            border-radius: 10px;
            border: 1px solid #BBF7D0;
        }

        .preview-title {
            font-weight: 600;
            color: var(--text);
            margin-bottom: 12px;
            font-size: 0.95rem;
        }

        .preview-tokens {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .token {
            padding: 6px 12px;
            background: white;
            border-radius: 6px;
            font-size: 0.9rem;
            border: 1px solid #86EFAC;
        }

        .token .tag {
            font-size: 0.75rem;
            color: var(--text-light);
            margin-left: 4px;
        }

        /* í˜•íƒœì†Œ ë¶„ì„ ê²°ê³¼ */
        .morpheme-result {
            margin-top: 16px;
            padding: 16px;
            background: #F8FAFC;
            border-radius: 10px;
            border: 1px solid var(--border);
        }

        .morpheme-sentence {
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px dashed var(--border);
        }

        .morpheme-sentence:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .morpheme-sentence-label {
            font-weight: 600;
            color: var(--primary);
            font-size: 0.85rem;
            margin-bottom: 6px;
        }

        .morpheme-tokens {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .morpheme-token-wrapper {
            position: relative;
            display: inline-block;
        }

        .morpheme-token {
            padding: 4px 10px;
            background: white;
            border-radius: 4px;
            font-size: 0.85rem;
            border: 1px solid var(--border);
        }

        .morpheme-token .tag {
            font-size: 0.65rem;
            color: #94a3b8;
            font-weight: 400;
            margin-left: 2px;
        }

        .morpheme-token .lex {
            font-size: 1rem;
            font-weight: 700;
            color: var(--text);
        }

        .morpheme-token.selected {
            background: #DBEAFE;
            border-color: #93C5FD;
        }

        .morpheme-token.excluded {
            background: #FEE2E2;
            border-color: #FECACA;
            text-decoration: line-through;
            opacity: 0.6;
        }

        .morpheme-token.stopword {
            background: #FEE2E2;
            border-color: #991B1B;
            color: #991B1B;
            font-weight: 600;
        }

        .morpheme-token:hover {
            transform: scale(1.05);
            transition: transform 0.2s ease;
        }

        .edit-icon {
            transition: opacity 0.2s ease, transform 0.2s ease;
        }

        .edit-icon:hover {
            opacity: 1 !important;
            transform: scale(1.3);
        }

        .stopword-tag {
            background: #FEE2E2 !important;
            color: #991B1B !important;
            border: 2px solid #991B1B !important;
            font-weight: 600;
        }

        .stopword-tag:hover {
            background: #FCA5A5 !important;
            transform: scale(1.05);
        }

        .inline-edit-box {
            position: absolute;
            z-index: 1000;
            animation: fadeIn 0.15s ease;
        }

        /* ì—ëŸ¬ ë©”ì‹œì§€ */
        .error-message {
            background: #FEF2F2;
            border: 1px solid #FECACA;
            color: #991B1B;
            padding: 16px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        /* ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.3s ease;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            body {
                padding: 16px;
            }

            h1 {
                font-size: 1.8rem;
            }

            .tabs {
                flex-wrap: wrap;
            }

            .tab {
                flex: 1 1 45%;
            }

            .settings {
                flex-direction: column;
                align-items: flex-start;
            }

            th, td {
                padding: 10px 12px;
                font-size: 0.85rem;
            }
        }

        /* ìƒíƒœ ë°°ì§€ */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .status-badge.loading {
            background: #FEF3C7;
            color: #92400E;
        }

        .status-badge.ready {
            background: #D1FAE5;
            color: #065F46;
        }

        .status-badge.error {
            background: #FEE2E2;
            color: #991B1B;
        }
    </style>
</head>
<body>
    <!-- ë¡œë”© ì˜¤ë²„ë ˆì´ -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">ğŸ”¤ í˜•íƒœì†Œ ë¶„ì„ê¸° ë¡œë”© ì¤‘...</div>
        <div class="loading-subtext">MeCab ëª¨ë¸ì„ ë¶ˆëŸ¬ì˜¤ê³  ìˆìŠµë‹ˆë‹¤ (ì•½ 1ì´ˆ)</div>
    </div>

    <div class="container">
        <header>
            <h1>ğŸ“Š TF-IDF ê³„ì‚° ì²´í—˜</h1>
            <p class="subtitle">AI í˜•íƒœì†Œ ë¶„ì„ìœ¼ë¡œ ë‹¨ì–´ì˜ ì¤‘ìš”ë„ë¥¼ ê³„ì‚°í•´ë³´ì„¸ìš”</p>
        </header>

        <!-- ì„¤ì • ì¹´ë“œ -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">
                    <span class="icon">âš™ï¸</span>
                    ê³„ì‚° ì„¤ì •
                </div>
                <span class="status-badge loading" id="statusBadge">
                    <span id="statusIcon">â³</span>
                    <span id="statusText">ë¡œë”© ì¤‘...</span>
                </span>
            </div>
            <div class="settings">
                <label class="checkbox-wrapper">
                    <input type="checkbox" id="useLog">
                    <span class="checkbox-label">IDFì— log ì ìš© (ì²´í¬ í•´ì œ = êµê³¼ì„œ ë°©ì‹: N/DF)</span>
                </label>
            </div>

            <!-- í’ˆì‚¬ íƒœê·¸ ì„ íƒ -->
            <div class="pos-tags-section">
                <div class="pos-tags-title">ğŸ“ ì¶”ì¶œí•  í’ˆì‚¬ ì„ íƒ (í´ë¦­í•˜ì—¬ ì„ íƒ/í•´ì œ, ğŸ” ì•„ì´ì½˜ í´ë¦­ ì‹œ ì„¤ëª… ë³´ê¸°)</div>
                <div class="pos-tags-container" id="posTagsContainer">
                    <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                </div>
            </div>
        </div>

        <!-- í’ˆì‚¬ ì„¤ëª… ëª¨ë‹¬ -->
        <div class="modal-overlay" id="posModal" onclick="closeModal(event)">
            <div class="modal-content" onclick="event.stopPropagation()">
                <div class="modal-header">
                    <div class="modal-title" id="modalTitle">í’ˆì‚¬ ì„¤ëª…</div>
                    <button class="modal-close" onclick="closeModal()">âœ•</button>
                </div>
                <div class="modal-body" id="modalBody">
                    <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
                </div>
            </div>
        </div>

        <!-- ë¬¸ì¥ ì…ë ¥ ì¹´ë“œ -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">
                    <span class="icon">ğŸ“</span>
                    Step 1: ë¬¸ì¥ ì…ë ¥
                </div>
            </div>
            <div style="margin-bottom: 12px;">
                <div style="color: var(--text-light); font-size: 0.9rem; margin-bottom: 8px;">
                    ğŸ’¡ í•œ ì¤„ì— í•˜ë‚˜ì”© ë¬¸ì¥ì„ ì…ë ¥í•´ì£¼ì„¸ìš” (ì¤„ë°”ê¿ˆ ë˜ëŠ” ë§ˆì¹¨í‘œë¡œ ë¬¸ì¥ êµ¬ë¶„)
                </div>
                <textarea id="documentsTextarea" 
                          class="document-input" 
                          rows="8" 
                          placeholder="ë¬¸ì¥ì„ ì…ë ¥í•˜ì„¸ìš” (ì¤„ë°”ê¿ˆ ë˜ëŠ” ë§ˆì¹¨í‘œë¡œ êµ¬ë¶„)&#10;ì˜ˆ: ì²« ë²ˆì§¸ ë¬¸ì¥&#10;ë‘ ë²ˆì§¸ ë¬¸ì¥&#10;ì„¸ ë²ˆì§¸ ë¬¸ì¥"
                          style="width: 100%; resize: vertical; min-height: 150px; font-family: inherit; line-height: 1.6;"></textarea>
            </div>
            <div class="button-group">
                <button class="btn btn-secondary" onclick="loadExample()">ğŸ“š ì˜ˆì‹œ ë¶ˆëŸ¬ì˜¤ê¸°</button>
                <button class="btn btn-primary" id="analyzeBtn" onclick="analyzeSentences()" disabled>ğŸ”¤ í˜•íƒœì†Œ ë¶„ì„í•˜ê¸°</button>
            </div>

            <!-- í˜•íƒœì†Œ ë¶„ì„ ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸° -->
            <div class="morpheme-result" id="morphemeResult" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <div class="preview-title">ğŸ”¤ Step 2: í˜•íƒœì†Œ ë¶„ì„ ê²°ê³¼ (ë‹¨ì–´ í¸ì§‘)</div>
                </div>
                <div style="background: #FEF3C7; border: 1px solid #FCD34D; color: #92400E; padding: 12px; border-radius: 8px; margin-bottom: 12px; font-size: 0.9rem;">
                    ğŸ’¡ <strong>í¸ì§‘ ê¸°ëŠ¥:</strong><br>
                    â€¢ <strong>ìë™ ë³€í™˜:</strong> ìì£¼ ì“°ëŠ” ë‹¨ì–´ëŠ” ê¸°ë³¸í˜•ìœ¼ë¡œ ìë™ ë³€í™˜ (âœ“ í‘œì‹œ)<br>
                    â€¢ <strong>ë¶ˆìš©ì–´ ì œê±°:</strong> ë‹¨ì–´ í´ë¦­í•˜ì—¬ ë¶ˆìš©ì–´ë¡œ ì§€ì •/í•´ì œ<br>
                    â€¢ <strong>ë‹¨ì–´ ìˆ˜ì •:</strong> âœï¸ ì•„ì´ì½˜ í´ë¦­í•˜ì—¬ ëª¨ë“  ë‹¨ì–´ ìˆ˜ì • ê°€ëŠ¥
                </div>
                <div id="morphemeContent"></div>
                <div style="margin-top: 16px; text-align: center; padding-top: 16px; border-top: 2px dashed #3B82F6;">
                    <div style="color: var(--primary); font-weight: 600; margin-bottom: 12px; font-size: 1.1rem;">
                        ğŸ‘‡ Step 3: TF-IDF ë¶„ì„
                    </div>
                    <button class="btn btn-primary" id="calculateBtn" onclick="calculate()" style="font-size: 1.1rem; padding: 14px 28px;">
                        ğŸ“Š ë¶„ì„í•˜ê¸°
                    </button>
                </div>
            </div>

            <!-- ì¶”ì¶œëœ ë‹¨ì–´ ë¯¸ë¦¬ë³´ê¸° -->
            <div class="preview-section" id="previewSection" style="display: none;">
                <div class="preview-title">âœ… ì¶”ì¶œëœ ë‹¨ì–´ (TF-IDF ê³„ì‚°ì— ì‚¬ìš©)</div>
                <div class="preview-tokens" id="previewTokens"></div>
            </div>
        </div>

        <!-- ê²°ê³¼ ì¹´ë“œ -->
        <div class="card" id="resultCard" style="display: none;">
            <div class="tabs">
                <button class="tab active" onclick="switchTab('tf')">TF (ë‹¨ì–´ ë¹ˆë„)</button>
                <button class="tab" onclick="switchTab('df')">DF (ë¬¸ì¥ ë¹ˆë„)</button>
                <button class="tab" onclick="switchTab('idf')">IDF (ì—­ë¬¸ì¥ ë¹ˆë„)</button>
                <button class="tab" onclick="switchTab('tfidf')">TF-IDF</button>
            </div>

            <!-- TF íƒ­ -->
            <div class="tab-content active" id="tab-tf">
                <div class="formula-box">
                    <div class="formula-title">TF (Term Frequency) ê³„ì‚° ê³µì‹</div>
                    <div class="formula" id="formula-tf"></div>
                </div>
                <div class="description">
                    <strong>TF(ë‹¨ì–´ ë¹ˆë„)</strong>ëŠ” íŠ¹ì • ë¬¸ì¥ì—ì„œ í•´ë‹¹ ë‹¨ì–´ê°€ ëª‡ ë²ˆ ë“±ì¥í•˜ëŠ”ì§€ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. 
                    ê°’ì´ í´ìˆ˜ë¡ í•´ë‹¹ ë¬¸ì¥ì—ì„œ ìì£¼ ì‚¬ìš©ëœ ë‹¨ì–´ì…ë‹ˆë‹¤.
                </div>
                <div class="table-container">
                    <table id="tfTable"></table>
                </div>
            </div>

            <!-- DF íƒ­ -->
            <div class="tab-content" id="tab-df">
                <div class="formula-box">
                    <div class="formula-title">DF (Document Frequency) ê³„ì‚° ê³µì‹</div>
                    <div class="formula" id="formula-df"></div>
                </div>
                <div class="description">
                    <strong>DF(ë¬¸ì¥ ë¹ˆë„)</strong>ëŠ” í•´ë‹¹ ë‹¨ì–´ê°€ ì „ì²´ ë¬¸ì¥ ì¤‘ ëª‡ ê°œì˜ ë¬¸ì¥ì— ë“±ì¥í•˜ëŠ”ì§€ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
                    ëª¨ë“  ë¬¸ì¥ì— ë“±ì¥í•˜ëŠ” ë‹¨ì–´ëŠ” DFê°€ ë†’ê³ , íŠ¹ì • ë¬¸ì¥ì—ë§Œ ìˆëŠ” ë‹¨ì–´ëŠ” DFê°€ ë‚®ìŠµë‹ˆë‹¤.
                </div>
                <div class="table-container">
                    <table id="dfTable"></table>
                </div>
            </div>

            <!-- IDF íƒ­ -->
            <div class="tab-content" id="tab-idf">
                <div class="formula-box">
                    <div class="formula-title">IDF (Inverse Document Frequency) ê³„ì‚° ê³µì‹</div>
                    <div class="formula" id="formula-idf"></div>
                </div>
                <div class="description">
                    <strong>IDF(ì—­ë¬¸ì¥ ë¹ˆë„)</strong>ëŠ” DFì˜ ì—­ìˆ˜ ê°œë…ìœ¼ë¡œ, í¬ê·€í•œ ë‹¨ì–´ì¼ìˆ˜ë¡ ê°’ì´ ì»¤ì§‘ë‹ˆë‹¤.
                    ë§ì€ ë¬¸ì¥ì— ë“±ì¥í•˜ëŠ” í”í•œ ë‹¨ì–´ëŠ” IDFê°€ ë‚®ê³ , íŠ¹ì • ë¬¸ì¥ì—ë§Œ ìˆëŠ” ë‹¨ì–´ëŠ” IDFê°€ ë†’ìŠµë‹ˆë‹¤.
                </div>
                <div class="table-container">
                    <table id="idfTable"></table>
                </div>
            </div>

            <!-- TF-IDF íƒ­ -->
            <div class="tab-content" id="tab-tfidf">
                <div class="formula-box">
                    <div class="formula-title">TF-IDF ìµœì¢… ê³„ì‚° ê³µì‹</div>
                    <div class="formula" id="formula-tfidf"></div>
                </div>
                <div class="description">
                    <strong>TF-IDF</strong>ëŠ” TFì™€ IDFë¥¼ ê³±í•œ ê°’ì…ë‹ˆë‹¤. 
                    íŠ¹ì • ë¬¸ì¥ì—ì„œ ìì£¼ ë“±ì¥í•˜ë©´ì„œ(TF ë†’ìŒ) ë‹¤ë¥¸ ë¬¸ì¥ì—ëŠ” ì˜ ì—†ëŠ”(IDF ë†’ìŒ) ë‹¨ì–´ê°€ ë†’ì€ ê°’ì„ ê°–ìŠµë‹ˆë‹¤.
                    ì´ëŸ° ë‹¨ì–´ê°€ í•´ë‹¹ ë¬¸ì¥ì„ ëŒ€í‘œí•˜ëŠ” <strong>í•µì‹¬ í‚¤ì›Œë“œ</strong>ì…ë‹ˆë‹¤.
                </div>
                <div class="table-container">
                    <table id="tfidfTable"></table>
                </div>
                <div class="legend" id="legend"></div>
            </div>
        </div>
    </div>

    <!-- MeCab.js ë¡œë“œ -->
    <script src="https://cdn.jsdelivr.net/npm/kuromoji@0.1.2/build/kuromoji.js"></script>
    <!-- mecab-ko-wasmì„ ì‚¬ìš© -->
    <script>
        // ====================================================================
        // ëª…ì‚¬ ì‚¬ì „ (ìƒìœ„ 1000ê°œ ê³ ë¹ˆë„ ëª…ì‚¬)
        // ====================================================================
        const NOUN_DICT = new Set([
            "ì˜ì–´", "ë¯¸êµ­", "ëŒ€í•œë¯¼êµ­", "ì„ ìˆ˜", "ì¼ë³¸", "ì¼ë³¸ì–´", "ë°°ìš°", "ìœ„ì¹˜", "ìŒë°˜", "ì¶•êµ¬",
            "ì‚¬ìš©", "ì˜í™”", "ì§€ì—­", "ì¸êµ¬", "ë„ì‹œ", "ì„¸ê³„", "ë…ì¼", "ë°œë§¤", "í™œë™", "ì´ë¦„",
            "ì˜êµ­", "êµ­ê°€", "ê¸°ì¤€", "í”„ë‘ìŠ¤", "ëŒ€í‘œ", "ì •ì¹˜ì¸", "ì˜¬ë¦¼í”½", "ë…ì¼ì–´", "í¬í•¨", "ê°€ìˆ˜",
            "ê°ë…", "ë°´ë“œ", "í¬ì§€ì…˜", "ì´í›„", "ìŠ¤íŠœë””ì˜¤", "ë¦¬ê·¸", "ìœ ëŸ½", "ì†Œì†", "ëŒ€í†µë ¹", "ì´íƒˆë¦¬ì•„",
            "í”„ë¡œ", "ìŠ¤í˜ì¸ì–´", "ì‹œì ˆ", "í”„ë‘ìŠ¤ì–´", "ì‚¬ì´", "í™œì•½", "ì¶œì‹ ", "ì² ë„", "ì‚¬ëŒ", "ìœ ëª…",
            "êµ¬ì„±", "í•œêµ­", "ì‹œëŒ€", "ëŸ¬ì‹œì•„", "ë©´ì ", "ì œì‘", "ê°œë°œ", "ê²Œì„", "ì§€êµ¬", "ê·¸ë£¹",
            "ì§€ì •", "ìµœì´ˆ", "ì¼ë°˜", "ì‹œì‘", "ê¸°ë¡", "ìŒì•…", "ì¼ë¶€", "ì¤‘êµ­ì–´", "ë“œë¼ë§ˆ", "ì—¬ì„±",
            "ì¤‘êµ­", "ì˜ë¯¸", "ë°œê²¬", "ì§€ë°©", "ëŒ€í•™", "í•˜ê³„", "ì—­ì‚¬", "ì²˜ìŒ", "ì‘í’ˆ", "ë°ë·”",
            "ì—¬ì", "ì—°ë°©", "ê¸°ê´€", "ê³µí™”êµ­", "ì£¼ìš”", "ìˆ˜ìƒ", "ì„¸í¬", "ë™ì•ˆ", "ë¸Œë¼ì§ˆ", "ë‹¹ì‹œ",
            "ì´ìƒ", "êµ­ë„", "íšë“", "ì—°êµ¬", "í˜„ì¬", "ì—­ì„", "í•™êµ", "ë ˆì½”ë“œ", "ë…ë¦½", "í–‰ì •",
            "ë¬¸í™”", "ì„¤ë¦½", "ì¡´ì¬", "ëª©ë¡", "êµìœ¡", "ìŠ¤ìœ„ìŠ¤", "ëŸ¬ì‹œì•„ì–´", "ì² ë„ì—­", "ì‚¬íšŒ", "í˜„ì—­",
            "ì—­í• ", "ì„¼í„°", "ì„¸ê¸°", "ì œêµ­", "ì•¼êµ¬", "ì‘ê°€", "ì‹œê°„", "ëŒ€ì „", "ì„œìš¸", "ë°œìƒ",
            "ìŠ¤í˜ì¸", "ì „ìŸ", "ê·¸ë¦¬ìŠ¤", "ì£¼ë„", "ë…¸ë˜", "ì •ë¶€", "ê³µë¦½", "êµ¬ì—­", "ì´ì „", "í•´ë‹¹",
            "ì¡°ì„ ", "ì¸ë„", "ì†Œì„¤", "ê¸¸ì´", "ê°€ìš´ë°", "êµ­ì œ", "ë„ì¿„", "ì¤‘ì‹¬", "ê²½ê¸°", "ë…¸ì„ ",
            "êµ¬ì¡°", "ë…¹ìŒ", "ë„ë¡œ", "ëŒ€íšŒ", "ë†êµ¬", "ë‹¤ì–‘", "ëŒ€í•™êµ", "ì°¸ê°€", "ìŠ¤ì›¨ë´", "ì¶œì—°",
            "ë³‘ìŒ", "ìµœê³ ", "êµ­ë¦½", "ì „íˆ¬", "ë¯¸ë“œí•„ë”", "ì œë„", "ìš´ì˜", "ì‹œë¦¬ì¦ˆ", "ë™ìª½", "ì¼ì¢…",
            "ìœ ë˜", "ìˆ˜ë„", "ìºë‚˜ë‹¤", "êµìˆ˜", "ë³´ì»¬", "í´ëŸ½", "ìµœëŒ€", "ëŒ€ë¶€ë¶„", "ì¥ê´€", "ê³ ë“±í•™êµ",
            "ë¶ë¶€", "ëª…ì¹­", "ë‚¨ìª½", "ì€í‡´", "ë°œí‘œ", "ì „ì§", "ë‚˜ë¼", "í¬ë¥´íˆ¬ê°ˆì–´", "ë¶ìª½", "ì´ìš©",
            "í…”ë ˆë¹„ì „", "íƒœì–‘", "ë©¤ë²„", "ê³µì‹", "ê¸°ëŠ¥", "ì˜ì›", "ì°¸ì—¬", "ì—°ê²°", "ì‹œì¦Œ", "ì„œìª½",
            "ì•¨ë²”", "ì¸ê°„", "ì¢…ëª©", "ë†’ì´", "í˜•íƒœ", "íšŒì‚¬", "ì‚¬ë§", "ê±´ë¬¼", "ìš©ì–´", "ë§ˆì§€ë§‰",
            "ì¤‘ì•™", "ë¡œë§ˆ", "ì˜¤ìŠ¤íŠ¸ë¦¬ì•„", "ìƒì‚°", "ê³¼ì •", "ì¢…ë¥˜", "ë¶„ì•¼", "ë¬¸í™”ì–´", "ì¥ì¹˜", "ë„¤ëœë€ë“œ",
            "ìœ ì¼", "ë‚¨ë¶€", "ìš°í¬ë¼ì´ë‚˜", "ë¶€ë¬¸", "ê´€í• ", "ì•„ë¥´í—¨í‹°ë‚˜", "ì •ì¹˜", "ëª¨ì–‘", "í‰ê°€",
            "í˜•ì„±", "ì‹œê¸°", "ììœ ", "ì‚°ì—…", "ì„¸ëŒ€", "ì˜í–¥", "ì‹ ê²½", "ì´ë¦¬", "ì†Œë ¨", "ê¸°ìˆ ",
            "ë²ˆí˜¸", "ìˆ˜ë¹„ìˆ˜", "ê±°ë¦¬", "ìƒíƒœ", "ê²½ê¸°ì¥", "ê³µê°œ", "ê·œëª¨", "ì œí’ˆ", "ë‹¨ìœ„", "ìŠ¤í¬ì¸ ",
            "ì§€ë„ì", "ì œê³µ", "ë™ë¬¼", "ë² íŠ¸ë‚¨", "ê´€ê³„", "ê³µí•­", "ì‹œìŠ¤í…œ", "ì°¨ì§€", "ìŠ¤íƒ€", "ê³µì›",
            "ëª¨ë¸", "ê²°í•©", "í”„ë¡œë“€ì„œ", "ë™ë¶€", "í•­ê³µ", "ë‚¨ì", "ì •ê·œ", "ì‘ê³¡ê°€", "ì•„í”„ë¦¬ì¹´",
            "ìœ„ì›", "ì‚¬ê±´", "ì „í†µ", "íŒë§¤", "ì–¸ì–´", "ì§„í–‰", "ë²„ìŠ¤", "íš¨ì†Œ", "ë°œìŒ", "ëŒ€ìƒ",
            "ë¹Œë³´ë“œ", "í˜„ëŒ€", "ì•„ëì–´", "ìœ¡êµ°", "ë‰´ìš•", "ì˜ˆìˆ ", "ì´ˆëŒ€", "ì¼ì›", "ì§€ì§„",
            "ê³µêµ°", "ì œì„ìŠ¤", "ê³µê°„", "ì•„ì¼ëœë“œ", "ê¸°ë°˜", "í´ë€ë“œ", "ìˆ˜í–‰", "ë°”ì´ëŸ¬ìŠ¤", "ì§€ì›",
            "ê¸°ì—…", "ì¡°ì§", "ëŠ¥ë ¥", "ì„±ê³µ", "íŠ¹ì •", "ë¬¸ì", "ë“±ì¥", "ë˜í¼", "ì‚¬ìš´ë“œ", "ì„œë¹„ìŠ¤",
            "ì˜í™”ë°°ìš°", "ì—°ê¸°", "ê³ ëŒ€", "êµíšŒ", "ê²½ì œ", "ë‹¨ë°±ì§ˆ", "í›„ë³´", "ë°©ë²•", "ë¶„í¬", "ì¢…êµ",
            "ì¸ê¸°", "ë¬¼ì§ˆ", "ì „ì²´", "í”„ë¡œê·¸ë¨", "êµí†µ", "ê³µê²©ìˆ˜", "í•´êµ°", "ì¤‘ìš”", "ê³µë™", "ì„ ì •",
            "ì»´í“¨í„°", "êµ¬ê°„", "ì‚¬ë¦½", "ì£¼ì˜", "ì£¼ë³€", "ê´€ë ¨", "ì°¨íŠ¸", "ìë™ì°¨", "í•™ëª…", "ì„¤ê³„",
            "ê±´ì„¤", "ê³¼ê±°", "ì„œìš¸íŠ¹ë³„ì‹œ", "ì„œë¶€", "ë¯¼ì¡±", "ë™ê³„", "ìš°ìŠ¹", "ì¡°ì•½", "ì‚¬ë‹¨", "ë“±ë¡",
            "ê´€ë¦¬", "ë°•ë¬¼ê´€", "ì—¬ê°", "í¬ê¸°", "ë…¸ë²¨", "ë³¸ë¶€", "ìœ¡ìƒ", "ê¸ˆë©”ë‹¬", "ë³¸ê´€", "ì‘ì—…",
            "ê·¸ë¦¬ìŠ¤ì–´", "ì€ë©”ë‹¬", "ì£¼ì—°", "êµ°ì¸", "ìŠ¹ê°•ì¥", "ìš´ë™ê°€", "ì‚°ë§¥", "ì „ì² ", "ë„ì„œê´€",
            "ìƒì„±", "ê°•ì›", "ë¹„ë””ì˜¤", "ì„ ê±°", "ë””ìì¸", "ì¤„ë¬´ëŠ¬", "ì„¤ì¹˜", "ì§€ë°°", "êµ¬ë¶„",
            "ì•„ë˜", "í™©ì œ", "ëª©ì ", "ê³µê²©", "ìë¦¬", "ì†Œí–‰ì„±", "ë§ë ˆì´ì‹œì•„", "ë©•ì‹œì½”", "êµ°ì‚¬",
            "ë¶„ì", "ë°œì „", "ë¬¸ì œ", "ì¸ë¬¼", "ëŒ€ë§Œ", "ì¤‘ì‹¬ì§€", "ì•½ì¹­", "ë¦¬ë“œ", "ì¢…í•©",
            "ì‹œì„¤", "ê³¨í‚¤í¼", "ì‚¬ì§„", "ì´ë¡ ", "í†µí•©", "ì •ë³´", "ì „ê¸°", "ë„“ì´", "ì†Œí”„íŠ¸ì›¨ì–´",
            "ê²°ì •", "ì¤‘ë¶€", "ì „ì—­", "ì•„ì¹´ë°ë¯¸", "ìœ„ì›íšŒ", "ê°œë…", "ì´ì§‘íŠ¸", "ê°œí†µ", "ì „ì„ ",
            "ì¹˜ë£Œ", "ì§€ëª…", "ê³ ì „", "ë¶„ë¥˜", "ì‹ í˜¸", "ìš´ë™", "ì´ì•¼ê¸°", "í—ê°€ë¦¬", "ê³ ì²´",
            "íƒœí’", "ì‹œì¸", "ì „ì", "ë¹™í•˜", "ì—°ì£¼ì", "ì „ë‹¬", "ì˜¨ë„", "íˆ¬ìˆ˜", "ì½œë¡¬ë¹„ì•„",
            "êµ­ë¯¼", "ê°€ëŠ¥", "ì‘ì „", "ë¶€ëŒ€", "ì „ì°¨", "ì¹ ë ˆ", "ê²°ê³¼", "ë³´í˜¸", "ìì—°",
            "í‘œì¤€", "ë„¤íŠ¸ì›Œí¬", "ì„¸ê· ", "ìƒì§•", "ê³„ì—´", "íŒŒë¦¬", "ì¸ì •", "ë‹´ë‹¹", "í•¸ë“œë³¼",
            "ì„ ê±°êµ¬", "ì§‘ë‹¨", "êµ¬ë³„", "ë‹¤ìŒ", "êµ­ê²½", "ì¹´ìš´í‹°", "í˜‘íšŒ", "ë³¸ì‚¬", "ë ë¦¬",
            "ì‚¬ê³ ", "ëŒ€ì‚¬", "í™”í•™", "ìƒí™œ", "ì¶œìƒ", "ê¸°ê°„", "ì •ìƒ", "ì •ì±…", "ë²”ì£„",
            "ìƒëŒ€", "í¬ë„", "ë¯¼ì£¼", "í•™ì", "ì¶œì‹œ", "ê³„íš", "ê´€ì¸¡", "ì˜ì—­", "ì›Œì‹±í„´",
            "í•©ì„±", "ë¯¼ì£¼ë‹¹", "í‘œí˜„", "ë¬´ì—­", "ì‘ê³¡", "ë©”ì´ì €", "ì„œì‹", "íƒ„ìƒ", "êµ­íšŒ",
            "ì´ˆê¸°", "íŠ¹ì§•", "ì˜ìƒ", "ëŒ€ì‹ ", "ì„±ì¥", "ì¤‘ê°„", "ì£¼ì¥", "ì„ì‹œ", "ì†Œë¹„ì",
            "ì•ˆì „", "ì˜íšŒ", "ë§ˆì´í´", "ë°©ì†¡", "ì‹¤í—˜", "ê±´ì¶•", "ì¸¡ì •", "ì˜¤í”ˆ", "ì •êµíšŒ",
            "ìš°ì£¼", "í˜¸ë¥¸", "í•„ë¦¬í•€", "í•„í„°", "ì•„ë¯¸ë…¸", "ì œì™¸", "ê¸°ê³„", "ë¡œë²„íŠ¸", "ì—´ì°¨",
            "í˜„ìƒ", "ì „ìš©", "ê±´ì¶•ë¬¼", "ì•„ë“¤", "ë¬˜ì‚¬", "ìœ ì‚°", "ê°œë´‰", "ì§€ë°”", "ì—°êµ¬ì†Œ",
            "ë¹„êµ", "ë¶•ê´´", "ë¹Œë”©", "ì¤‘í•™êµ", "í™”í•™ì", "ì‘ìš©", "ì§€ëŒ€", "ê³¨ë“ ", "ê¶¤ë„",
            "ê³µê´€", "ì •ì˜", "í†µê³¼", "ê°„ì£¼", "í‘œê¸°", "ìœ ê¸°", "ë‚´ê°", "ì¡°ì‚¬", "í”„ë¡œì íŠ¸",
            "ìì‹ ", "ì œëª©", "ìš”ë¦¬", "ë¬¸ì„œ", "ì‹œì¥", "ê³„ì•½", "ê¸°íƒ€", "ì•„ì‹œì•„", "ìœŒë¦¬ì—„",
            "í‰ë¡ ê°€", "ë…¸ë¥´ì›¨ì´", "í™ì½©", "íƒˆí‡´", "ê¼¬ë¦¬", "ì™•êµ­", "í•™ìƒ", "ì™¸ë¶€", "ìƒì—…",
            "ì¶œì „", "êµ­ë¦½ê³µì›", "ì„ ìˆ˜ë‹¨", "ìˆ˜ë¡", "ì§€ì ", "ìš´í–‰", "ë£¨ì´ìŠ¤", "ì—°ê·¹", "ì§€í•˜ì² ",
            "ë‚¨ë™ë¶€", "ê³¼í•™", "ìƒë¬¼", "íƒœêµ­", "íƒœí‰ì–‘", "ë°©ì‹", "ì‹ë¬¼", "í–‰ì„±", "ë¯¸êµ­ì¸",
            "ì„±ë‹¹", "í•œêµ­ì–´", "ì „ë¬¸", "ì£¼ë‹ˆì–´", "ì „ì§€", "ì„±ë¶„", "ìíšŒì‚¬", "ì„¤ì¹˜ë¥˜", "ì—°ì†",
            "ì¹¼ë¦¬ì§€", "ì œì¡°", "ì˜¤ëŠ˜ë‚ ", "ì •ì ", "ë³„ëª…", "ì• í”Œ", "ê°œìµœ", "ì•„ë²„ì§€", "ê²½ê³„",
            "ì‹œê°", "ìŒì•…ê°€", "ê³µë¬´ì›", "ì—…ë¬´", "ëŒ€ì¤‘", "ì§€ì§€", "ì¶”ì •", "ë°€ë„", "ìŠ¤íƒ€ì¼",
            "ê¸°ë³¸", "ì¶”ì‚°", "ìˆœìœ„", "ë‹¤ë¦¬", "ì›ë˜", "ì´ë™", "íšŒì˜", "ë™ë§¥", "ì¬ì¦ˆ",
            "ì²´ê³„", "ì‹œë¦¬ì•„", "ì´ë€", "ê³„ë‹¨", "ê°¤ëŸ­ì‹œ", "ë°”ë‹¤", "ì‹í’ˆ", "ì €ì¥", "ìœ ì§€",
            "ì½”ì¹˜", "ë³´ìœ ", "í™”í•©ë¬¼", "ì¼ëŒ€", "ë‚¨ì•„ë©”ë¦¬ì¹´", "ë§ˆë“œë¦¬ë“œ", "ë°©í–¥", "ë°ì´ë¹„ìŠ¤",
            "ì •ë§¥", "ë¬¸ì‹ ", "ì¼ì œ", "ê°•ì ê¸°", "ê²½ì£¼", "ë°©ì˜", "íƒ€ì›Œ", "ë§ˆì²œë£¨", "ì‚¬ë‘",
            "ë™ë©”ë‹¬", "ì¸ê·¼", "ê·¸ë¦¼", "ì´ë¯¸ì§€", "ëª¨ë°”ì¼", "ì˜¬í•´", "ê³„ê¸‰", "ì¹´ë“œ", "ì„¤ëª…",
            "í”¼í„°", "ë¬¸í™”ì¬", "í•„ìš”", "ë³µí•©", "ë‹¬ì„±", "ë³¼ë¦¬ë¹„ì•„", "ìƒë¬¼í•™", "íŠ¸ë™", "ê¸°ë…",
            "ì²œì²´", "ì›ì‘", "ì‹ í™”", "ì—¬ì‹ ", "ë¼í‹´ì–´", "ì†Œì„¤ê°€", "í˜ëª…", "ì‚¬ìš©ì", "ì—°í•©",
            "ì•…ê¸°", "ë³€í™”", "ì˜í–¥ë ¥", "íš¨ê³¼", "ë¯¸ìˆ ", "ë¸Œë¼ìš´", "êµ­ì™•", "ê²°ì„±", "ê¸°ì²´",
            "ë°ì´í„°", "ì†ë„", "ë¶„ë¦¬", "ì°°ìŠ¤", "ì˜í† ", "ë””ìŠ¤í¬", "ê°œì¸", "ì ë ¹", "ì†Œë‹ˆ",
            "ì†Œì¬ì§€", "ì°¨ë¡€", "ì•„ì´", "ê·¼ìœ¡", "ì¥ì†Œ", "ì œì •", "ì—­ëŒ€", "ë©”ë‹¬", "ëŸ°ë˜",
            "ë™ëª…", "ë°•ì¥", "ë Œì¦ˆ", "êµ¬ë‹¨", "ì†”ë¡œ", "ëƒ‰ì¥ê³ ", "ì´í•˜", "íˆíŠ¸", "ëŒ€ì²´",
            "íšŒì¥", "ë¬¼ê±´", "ê¸°êµ¬", "í‰ê· ", "ìš°ìˆ˜", "ì •ì²´", "êµ­êµ°", "ì•„ë‚´", "ì•ˆì •",
            "ë¼ì´íŠ¸", "ì§„ë„", "ë°•ì‚¬", "ì¼ì •", "ì´ì˜¨", "í•­ì„±", "í™•ì¸", "ì°¨ì´", "ì „ë ¥",
            "ì²´ìœ¡", "ìš”ì†Œ", "ìœ ì „ì", "ë¶ë™ë¶€", "ê¸€ë¡œë¸Œ", "ë‚¨ìš°", "ì—¬ìš°", "ë™ë§¹",
            "ê°ë³¸", "ëª¨ìŠµ", "ìœˆë„ìš°", "ìµœì¢…", "ë§ˆì„", "ëƒ„ìƒˆ", "ë…¸ë™", "íŠ¹ë³„ì‹œ", "í¬ë„ì£¼",
            "ì¥ë¥´", "í”Œë ˆì´ì–´", "ì‹œë¯¼", "ë¶€ì¡±", "ì•½ë¬¼", "ì œí•œ", "ì•”ì»·", "ìŒì‹", "ì‹¤ì‹œ",
            "ì§ˆë³‘", "ìƒì›", "ì´ì", "ì‚¬ì—…", "ì§ˆëŸ‰", "ê³ ë¦¬", "ê·¼ì²˜", "ê·¼ë¬´", "ê´€êµ¬",
            "ìœ™ì–´", "ì½”ë§ˆ", "ì°¨ì›", "ì¡°ì ˆ", "ê°ì—¼", "ì§„ë‹¨", "ì½”ë“œ", "ë¶„í•´", "í˜¸ìˆ˜",
            "í™í•©", "ì¼€ì´ë¸”", "ì¤„ê¸°", "ì¼€ë„¤ë””", "ì–´ë¨¸ë‹ˆ", "ë¼ì¸", "ëª°ë„ë°”", "ì¸í„°ë„·",
            "ì—°ì„¤", "ë‹¹ì„ ", "ìë£Œ", "ë ˆì´ì €", "íŠ¹ì´", "ë¬¸í•™", "ê´€ì‹¬", "ê°€ìŠ¤", "ìš©í•´ë„",
            "í—Œë²•", "ìœ„ì¥", "ë‚¨ì„±", "ê±°ëŒ€", "ë´‰í™©", "ìì „ê±°", "í™˜ê²½", "ì¥êµ°", "ê²½ë ¥",
            "ì™¸ì•¼ìˆ˜", "ì²˜ë¦¬", "ì„ëª…", "ìœ í˜•", "ì·¨ê¸‰", "ìœ ì—”", "ì‚°í•˜", "ìŒë‘¥ì´", "ì¸ì ‘",
            "ê¸°ì§€", "ê²°í˜¼", "ë³´ì´", "ì½©ê³ ", "ìµœê·¼", "ì² í•™ì", "ê¸°ì›", "í•„ë¦„", "ì´ˆì ",
            "ì•ˆë“œë¡œì´ë“œ", "íˆ¬ì–´", "ì¢…ë£Œ", "ì˜ˆì •", "ëª…ëª…", "í—¨ë¦¬", "ê¸°ì¡´", "ë¶ì„œë¶€",
            "ì •ì‹", "ìŠ¤í†°", "í•­ê³µê¸°", "í™”ì¬", "ì²´ì œ", "ë‹¨ì„ ", "ë¸Œëœë“œ", "ì ìš©", "ì§ˆí™˜",
            "ë¶ˆêµ", "ì‹œìƒì‹", "ì „ì² ì—­", "ì‚¬ìƒ", "ì£¼ì¬", "ì•„ë¯¸ë…¸ì‚°", "í˜‘ë ¥", "ë‚´ìš©", "ë¨¸ë¦¬",
            "ë™ì¼", "ë„ˆë¹„", "ì´ìœ ", "ì£¼ëª©", "ì§€ì¹­", "ë°˜ëŒ€", "ì ‘ì´‰", "ìš°ë£¨ê³¼ì´", "ì œì–´",
            "ë¶„ì§€", "í™”ì„", "ì„±ìš°", "ì „êµ­", "ë‚ ê°œ", "ì—°ì¬", "ì¥ì• ", "ì§€ê¸ˆ", "êµ¬ì„±ì›",
            "í™”ê°€", "ë°”íƒ•", "ê°€ì‚¬", "ë‹¨ê³„", "í•´ì²´", "ì—¬í–‰", "ê³µêµ­", "í•´ì•ˆ", "ì¶œê°„",
            "ê±°ì£¼", "ì‹ ë¶„", "ë¹…í† ë¦¬ì•„", "ë¦¬ìŠ¤íŠ¸", "ëª¨ìŠ¤í¬ë°”", "ê¸°íš", "ìƒí˜¸", "ì••ë ¥",
            "í•©ë¥˜", "ê²½ë¡œ", "ìˆ˜ì»·", "ì•„í…Œë„¤", "ë‰´ì§ˆëœë“œ", "ì–´ì›Œë“œ", "ê¸°ì§ˆ", "í¸ì§‘",
            "ì—°ì¥", "ë² ë¥¸", "í”¼ë‹‰ìŠ¤", "ì—°ì¶œ", "ë””ìì´ë„ˆ", "ììŒ", "ì‚¼ì„±", "ì±”í”¼ì–¸",
            "ë°œì‚¬", "í›„ë°˜", "í•©ë³‘", "ë¦¬ì˜¹", "í–¥í† ", "ë°˜ë„", "ê¸°ë…êµ", "ì¶œë°œ", "í•‘í¬",
            "ë³´ë³‘", "ë²•ë¥ ", "ì œì‚¬ì¥", "ìë°”", "ìœ ì¹˜ì›", "í˜ë†€", "ì•„ì´í°", "ë²”ìœ„",
            "ì„ ì–¸", "ì •ì°¨", "ì—ë„ˆì§€", "ë°©ì¶œ", "ì¡°í•©", "ë™ìƒ", "íŒ¨ìŠ¤", "ë™ë£Œ", "í™•ì¥",
            "êµ°ì²­", "ë‹¨ì§€", "ì‚¬ë ¹ë¶€", "ìš´ë°˜", "ìŒë ¥", "ë§ê¸°", "ê°œì¥", "ì¥ê¸°", "ìœ ì‚¬",
            "ì¬ì„", "ë‚´ì „", "ë¬¼ì²´", "íœì‹±", "ì›”ë“œ", "ê¶Œíˆ¬", "ë“±ì¬", "ì¥í¸", "ê¸°ìƒì²­",
            "ê°•ì•„ì§€", "ê°„ì‹", "ëƒ„ìƒˆ", "ì•Œë ˆë¥´ê¸°", "ê±±ì •", "ì…ë§›", "ë°˜ì‘", "ê°€ê²©", "ì„±ë¶„", "ì‚°ì±…",
            "ìŠ¤ë§ˆíŠ¸í°", "ì¹´ë©”ë¼", "ì„±ëŠ¥", "ë°°í„°ë¦¬", "ë””ìì¸", "ë¬´ê²Œ", "ì‚¬ì§„", "ì œí’ˆ",
            "ë¬¸ì œì§‘", "ì„¤ëª…", "ì‹œí—˜", "ëŒ€ë¹„", "ì±…", "ë‚œì´ë„", "ìˆ˜í•™", "ìœ í˜•", "ë°˜ë³µ", "í•™ìŠµ", "ê°œë…", "ì •ë¦¬",
            "í”¼ì", "ì¹˜ì¦ˆ", "í•™ìƒ", "ì¹œêµ¬", "í¬ê¸°", "ì£¼ë¬¸", "ìŒì‹", "ì ì‹¬", "ì‹œê°„", "ìë¦¬",
            "ì‚¬ê³¼", "ë°”ë‚˜ë‚˜", "ë”¸ê¸°", "ì£¼ìŠ¤"
        ]);

        // ====================================================================
        // ê°œì„ ëœ í˜•íƒœì†Œ ë¶„ì„ê¸° í´ë˜ìŠ¤
        // ====================================================================
        class MeCabWrapper {
            constructor() {
                this.initialized = false;
            }

            async initialize() {
                this.initialized = true;
                return this;
            }

            analyze(text) {
                const words = [];
                // ê³µë°±ê³¼ êµ¬ë‘ì ìœ¼ë¡œ ë¶„ë¦¬
                const tokens = text.split(/\s+/);

                tokens.forEach(token => {
                    if (!token) return;
                    
                    // êµ¬ë‘ì  ì œê±°
                    token = token.replace(/[.,!?;:'"()]/g, '');
                    if (!token) return;

                    const morphs = this.maxMatchingParse(token);
                    if (morphs.length > 0) {
                        words.push({ morphs });
                    }
                });

                return words;
            }

            // ìµœëŒ€ ë§¤ì¹­ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•œ í˜•íƒœì†Œ ë¶„ì„
            maxMatchingParse(word) {
                const morphemes = [];
                let pos = 0;

                while (pos < word.length) {
                    let maxLen = 0;
                    let foundNoun = null;

                    // í˜„ì¬ ìœ„ì¹˜ì—ì„œ ê°€ì¥ ê¸´ ëª…ì‚¬ ì°¾ê¸° (ìµœëŒ€ 10ê¸€ìê¹Œì§€)
                    for (let len = Math.min(10, word.length - pos); len >= 1; len--) {
                        const substr = word.substring(pos, pos + len);
                        if (NOUN_DICT.has(substr)) {
                            maxLen = len;
                            foundNoun = substr;
                            break;
                        }
                    }

                    if (foundNoun) {
                        // ëª…ì‚¬ ì‚¬ì „ì—ì„œ ë°œê²¬
                        morphemes.push({ lex: foundNoun, tag: 'NNG' });
                        pos += maxLen;
                    } else {
                        // ëª…ì‚¬ ì‚¬ì „ì— ì—†ìœ¼ë©´ ì¡°ì‚¬/ì–´ë¯¸ ë¶„ë¦¬ ì‹œë„
                        const remaining = word.substring(pos);
                        const parsed = this.parseParticle(remaining);
                        
                        if (parsed.length > 0) {
                            morphemes.push(...parsed);
                            break; // ë‚˜ë¨¸ì§€ ì „ì²´ ì²˜ë¦¬ ì™„ë£Œ
                        } else {
                            // íŒŒì‹± ì‹¤íŒ¨ ì‹œ 1ê¸€ì ëª…ì‚¬ë¡œ ì²˜ë¦¬
                            morphemes.push({ lex: word.charAt(pos), tag: 'NNG' });
                            pos++;
                        }
                    }
                }

                return morphemes;
            }

            // ì¡°ì‚¬/ì–´ë¯¸ ë¶„ë¦¬
            parseParticle(word) {
                const morphemes = [];

                // ì¡°ì‚¬ íŒ¨í„´ (ë¹ˆë„ìˆœ)
                const particles = [
                    // 2ê¸€ì ì¡°ì‚¬
                    { suffix: 'ì—ì„œ', tag: 'JKB' },
                    { suffix: 'ì—ê²Œ', tag: 'JKB' },
                    { suffix: 'í•œí…Œ', tag: 'JKB' },
                    { suffix: 'ê¹Œì§€', tag: 'JX' },
                    { suffix: 'ë¶€í„°', tag: 'JX' },
                    { suffix: 'ì¡°ì°¨', tag: 'JX' },
                    { suffix: 'ë§ˆì €', tag: 'JX' },
                    { suffix: 'ìœ¼ë¡œ', tag: 'JKB', needFinal: true },
                    { suffix: 'ì´ë‘', tag: 'JC', needFinal: true },
                    // 1ê¸€ì ì¡°ì‚¬
                    { suffix: 'ì€', tag: 'JX', needFinal: true },
                    { suffix: 'ì„', tag: 'JKO', needFinal: true },
                    { suffix: 'ê³¼', tag: 'JC', needFinal: true },
                    { suffix: 'ëŠ”', tag: 'JX', needFinal: false },
                    { suffix: 'ë¥¼', tag: 'JKO', needFinal: false },
                    { suffix: 'ì™€', tag: 'JC', needFinal: false },
                    { suffix: 'ë¡œ', tag: 'JKB', needFinal: false },
                    { suffix: 'ë‘', tag: 'JC', needFinal: false },
                    { suffix: 'ì´', tag: 'JKS', needFinal: true },
                    { suffix: 'ê°€', tag: 'JKS', needFinal: false },
                    { suffix: 'ì—', tag: 'JKB' },
                    { suffix: 'ë„', tag: 'JX' },
                    { suffix: 'ë§Œ', tag: 'JX' }
                ];

                // ì–´ë¯¸ íŒ¨í„´
                const endings = [
                    { suffix: 'ìŠµë‹ˆë‹¤', tag: 'EF' },
                    { suffix: 'ã…‚ë‹ˆë‹¤', tag: 'EF' },
                    { suffix: 'ì—ˆì–´ìš”', tag: 'EF' },
                    { suffix: 'ì•˜ì–´ìš”', tag: 'EF' },
                    { suffix: 'ê² ì–´ìš”', tag: 'EF' },
                    { suffix: 'í–ˆì–´ìš”', tag: 'EF' },
                    { suffix: 'ì´ì—ìš”', tag: 'EF' },
                    { suffix: 'ì˜ˆìš”', tag: 'EF' },
                    { suffix: 'ì—ˆë‹¤', tag: 'EF' },
                    { suffix: 'ì•˜ë‹¤', tag: 'EF' },
                    { suffix: 'í–ˆë‹¤', tag: 'EF' },
                    { suffix: 'í•œë‹¤', tag: 'EF' },
                    { suffix: 'ëœë‹¤', tag: 'EF' },
                    { suffix: 'ê² ë‹¤', tag: 'EF' },
                    { suffix: 'ì–´ìš”', tag: 'EF' },
                    { suffix: 'ì•„ìš”', tag: 'EF' },
                    { suffix: 'ìš”', tag: 'EF' },
                    { suffix: 'ë‹¤', tag: 'EF' }
                ];

                // ì¡°ì‚¬ ë¨¼ì € ì‹œë„
                for (const particle of particles) {
                    if (word.endsWith(particle.suffix) && word.length > particle.suffix.length + 1) {
                        const base = word.slice(0, -particle.suffix.length);
                        
                        // ë°›ì¹¨ ì¡°ê±´ ê²€ì‚¬
                        if (particle.needFinal !== undefined) {
                            const lastChar = base[base.length - 1];
                            const hasFinal = this.hasFinalConsonant(lastChar);
                            if (particle.needFinal !== hasFinal) continue;
                        }

                        morphemes.push({ lex: base, tag: 'NNG' });
                        morphemes.push({ lex: particle.suffix, tag: particle.tag });
                        return morphemes;
                    }
                }

                // ì–´ë¯¸ ì‹œë„
                for (const ending of endings) {
                    if (word.endsWith(ending.suffix) && word.length > ending.suffix.length) {
                        const base = word.slice(0, -ending.suffix.length);
                        morphemes.push({ lex: base, tag: 'VV' });
                        morphemes.push({ lex: ending.suffix, tag: ending.tag });
                        return morphemes;
                    }
                }

                // íŒŒì‹± ì‹¤íŒ¨ - ì „ì²´ë¥¼ ëª…ì‚¬ë¡œ
                if (word.length > 0) {
                    morphemes.push({ lex: word, tag: 'NNG' });
                }

                return morphemes;
            }

            // ë°›ì¹¨ ìœ ë¬´ í™•ì¸
            hasFinalConsonant(char) {
                if (!char) return false;
                const code = char.charCodeAt(0) - 0xAC00;
                if (code < 0 || code > 11171) return false;
                return (code % 28) !== 0;
            }
        }
    </script>
    
    <script>
        // ì „ì—­ ë³€ìˆ˜
        let mecab = null;
        let documents = [];
        let words = [];
        let tfMatrix = [];
        let dfVector = [];
        let idfVector = [];
        let tfidfMatrix = [];
        let selectedWord = null;
        let stopWords = new Set(); // ë¶ˆìš©ì–´ ëª©ë¡
        let allMorphemes = []; // í˜•íƒœì†Œ ë¶„ì„ ê²°ê³¼ ì €ì¥

        // ìì£¼ ì“°ëŠ” ë™ì‚¬/í˜•ìš©ì‚¬/ëª…ì‚¬ ìë™ ë³€í™˜ ì‚¬ì „
        const verbStemDict = {
            // ì¢‹ë‹¤ ê³„ì—´ (í™•ì¥)
            'ì¢‹ì•„í•˜': 'ì¢‹ë‹¤', 'ì¢‹ì•„í•´': 'ì¢‹ë‹¤', 'ì¢‹ì•„': 'ì¢‹ë‹¤', 'ì¢‹ì€': 'ì¢‹ë‹¤', 'ì¢‹': 'ì¢‹ë‹¤',
            'ì¢‹ê³ ': 'ì¢‹ë‹¤', 'ì¢‹ì•„ìš”': 'ì¢‹ë‹¤', 'ì¢‹ë„¤ìš”': 'ì¢‹ë‹¤', 'ì¢‹ìŠµë‹ˆë‹¤': 'ì¢‹ë‹¤',
            // í•˜ë‹¤ ê³„ì—´ (í™•ì¥)
            'í–ˆ': 'í•˜ë‹¤', 'í•´': 'í•˜ë‹¤', 'í•˜': 'í•˜ë‹¤', 'í•˜ëŠ”': 'í•˜ë‹¤', 'í•œ': 'í•˜ë‹¤',
            'í•˜ê³ ': 'í•˜ë‹¤', 'í•´ìš”': 'í•˜ë‹¤', 'í•©ë‹ˆë‹¤': 'í•˜ë‹¤', 'í•˜ë„¤ìš”': 'í•˜ë‹¤',
            // ìˆë‹¤ ê³„ì—´ (í™•ì¥)
            'ìˆì–´': 'ìˆë‹¤', 'ìˆëŠ”': 'ìˆë‹¤', 'ìˆ': 'ìˆë‹¤', 'ìˆê³ ': 'ìˆë‹¤', 
            'ìˆì–´ìš”': 'ìˆë‹¤', 'ìˆìŠµë‹ˆë‹¤': 'ìˆë‹¤', 'ìˆë„¤ìš”': 'ìˆë‹¤',
            // ì—†ë‹¤ ê³„ì—´ (í™•ì¥)
            'ì—†ì–´': 'ì—†ë‹¤', 'ì—†ëŠ”': 'ì—†ë‹¤', 'ì—†': 'ì—†ë‹¤', 'ì—†ê³ ': 'ì—†ë‹¤',
            'ì—†ì–´ìš”': 'ì—†ë‹¤', 'ì—†ìŠµë‹ˆë‹¤': 'ì—†ë‹¤', 'ì—†ë„¤ìš”': 'ì—†ë‹¤',
            // ì‚¬ë‹¤ ê³„ì—´
            'ì‚¬': 'ì‚¬ë‹¤', 'ìƒ€': 'ì‚¬ë‹¤', 'ì‚¬ëŠ”': 'ì‚¬ë‹¤', 'ì‚°': 'ì‚¬ë‹¤',
            'ì‚¬ê³ ': 'ì‚¬ë‹¤', 'ì‚¬ìš”': 'ì‚¬ë‹¤', 'ì‚½ë‹ˆë‹¤': 'ì‚¬ë‹¤',
            // ë¨¹ë‹¤ ê³„ì—´ (í™•ì¥)
            'ë¨¹': 'ë¨¹ë‹¤', 'ë¨¹ì–´': 'ë¨¹ë‹¤', 'ë¨¹ëŠ”': 'ë¨¹ë‹¤', 'ë¨¹ì€': 'ë¨¹ë‹¤',
            'ë¨¹ê³ ': 'ë¨¹ë‹¤', 'ë¨¹ì–´ìš”': 'ë¨¹ë‹¤', 'ë¨¹ìŠµë‹ˆë‹¤': 'ë¨¹ë‹¤',
            // ë§Œë“¤ë‹¤ ê³„ì—´ (í™•ì¥)
            'ë§Œë“¤': 'ë§Œë“¤ë‹¤', 'ë§Œë“œ': 'ë§Œë“¤ë‹¤', 'ë§Œë“ ': 'ë§Œë“¤ë‹¤', 'ë§Œë“¤ì–´': 'ë§Œë“¤ë‹¤',
            'ë§Œë“¤ê³ ': 'ë§Œë“¤ë‹¤', 'ë§Œë“¤ì–´ìš”': 'ë§Œë“¤ë‹¤', 'ë§Œë“­ë‹ˆë‹¤': 'ë§Œë“¤ë‹¤',
            // ë³´ë‹¤ ê³„ì—´ (í™•ì¥)
            'ë³´': 'ë³´ë‹¤', 'ë´': 'ë³´ë‹¤', 'ë³´ëŠ”': 'ë³´ë‹¤', 'ë³¸': 'ë³´ë‹¤',
            'ë³´ê³ ': 'ë³´ë‹¤', 'ë´ìš”': 'ë³´ë‹¤', 'ë´…ë‹ˆë‹¤': 'ë³´ë‹¤',
            // ê°€ë‹¤ ê³„ì—´ (í™•ì¥)
            'ê°€': 'ê°€ë‹¤', 'ê°„': 'ê°€ë‹¤', 'ê°€ëŠ”': 'ê°€ë‹¤', 'ê°€ê³ ': 'ê°€ë‹¤',
            'ê°€ìš”': 'ê°€ë‹¤', 'ê°‘ë‹ˆë‹¤': 'ê°€ë‹¤',
            // ì˜¤ë‹¤ ê³„ì—´ (í™•ì¥)
            'ì™€': 'ì˜¤ë‹¤', 'ì˜¨': 'ì˜¤ë‹¤', 'ì˜¤ëŠ”': 'ì˜¤ë‹¤', 'ì˜¤ê³ ': 'ì˜¤ë‹¤',
            'ì™€ìš”': 'ì˜¤ë‹¤', 'ì˜µë‹ˆë‹¤': 'ì˜¤ë‹¤',
            // ë˜ë‹¤ ê³„ì—´ (í™•ì¥)
            'ë˜': 'ë˜ë‹¤', 'ëœ': 'ë˜ë‹¤', 'ë˜ëŠ”': 'ë˜ë‹¤', 'ë¼': 'ë˜ë‹¤',
            'ë˜ê³ ': 'ë˜ë‹¤', 'ë¼ìš”': 'ë˜ë‹¤', 'ë©ë‹ˆë‹¤': 'ë˜ë‹¤',
            // ì£¼ë‹¤ ê³„ì—´ (í™•ì¥)
            'ì£¼': 'ì£¼ë‹¤', 'ì¤€': 'ì£¼ë‹¤', 'ì£¼ëŠ”': 'ì£¼ë‹¤', 'ì¤˜': 'ì£¼ë‹¤',
            'ì£¼ê³ ': 'ì£¼ë‹¤', 'ì¤˜ìš”': 'ì£¼ë‹¤', 'ì¤ë‹ˆë‹¤': 'ì£¼ë‹¤',
            // ë°›ë‹¤ ê³„ì—´ (í™•ì¥)
            'ë°›': 'ë°›ë‹¤', 'ë°›ì•„': 'ë°›ë‹¤', 'ë°›ëŠ”': 'ë°›ë‹¤', 'ë°›ì€': 'ë°›ë‹¤',
            'ë°›ê³ ': 'ë°›ë‹¤', 'ë°›ì•„ìš”': 'ë°›ë‹¤', 'ë°›ìŠµë‹ˆë‹¤': 'ë°›ë‹¤',
            // ì“°ë‹¤ ê³„ì—´ (í™•ì¥)
            'ì¨': 'ì“°ë‹¤', 'ì“´': 'ì“°ë‹¤', 'ì“°ëŠ”': 'ì“°ë‹¤', 'ì“°ê³ ': 'ì“°ë‹¤',
            'ì¨ìš”': 'ì“°ë‹¤', 'ì”ë‹ˆë‹¤': 'ì“°ë‹¤',
            // ì°¾ë‹¤ ê³„ì—´ (í™•ì¥)
            'ì°¾': 'ì°¾ë‹¤', 'ì°¾ì•„': 'ì°¾ë‹¤', 'ì°¾ëŠ”': 'ì°¾ë‹¤', 'ì°¾ì€': 'ì°¾ë‹¤',
            'ì°¾ê³ ': 'ì°¾ë‹¤', 'ì°¾ì•„ìš”': 'ì°¾ë‹¤', 'ì°¾ìŠµë‹ˆë‹¤': 'ì°¾ë‹¤',
            // ë‚˜ì˜¤ë‹¤ ê³„ì—´ (í™•ì¥)
            'ë‚˜ì™€': 'ë‚˜ì˜¤ë‹¤', 'ë‚˜ì˜¨': 'ë‚˜ì˜¤ë‹¤', 'ë‚˜ì˜¤ëŠ”': 'ë‚˜ì˜¤ë‹¤',
            'ë‚˜ì˜¤ê³ ': 'ë‚˜ì˜¤ë‹¤', 'ë‚˜ì™€ìš”': 'ë‚˜ì˜¤ë‹¤', 'ë‚˜ì˜µë‹ˆë‹¤': 'ë‚˜ì˜¤ë‹¤',
            // ë“¤ì–´ê°€ë‹¤ ê³„ì—´ (í™•ì¥)
            'ë“¤ì–´ê°€': 'ë“¤ì–´ê°€ë‹¤', 'ë“¤ì–´ê°„': 'ë“¤ì–´ê°€ë‹¤', 'ë“¤ì–´ê°€ëŠ”': 'ë“¤ì–´ê°€ë‹¤',
            'ë“¤ì–´ê°€ê³ ': 'ë“¤ì–´ê°€ë‹¤', 'ë“¤ì–´ê°€ìš”': 'ë“¤ì–´ê°€ë‹¤',
            // ì–´ìš¸ë¦¬ë‹¤ ê³„ì—´ (í™•ì¥)
            'ì–´ìš¸ë ¤': 'ì–´ìš¸ë¦¬ë‹¤', 'ì–´ìš¸ë¦¬': 'ì–´ìš¸ë¦¬ë‹¤', 'ì–´ìš¸ë¦°': 'ì–´ìš¸ë¦¬ë‹¤',
            'ì–´ìš¸ë¦¬ê³ ': 'ì–´ìš¸ë¦¬ë‹¤', 'ì–´ìš¸ë ¤ìš”': 'ì–´ìš¸ë¦¬ë‹¤',
            // ê´œì°®ë‹¤ ê³„ì—´ (í™•ì¥ - ëª…ì‚¬í˜• í¬í•¨)
            'ê´œì°®ì•„': 'ê´œì°®ë‹¤', 'ê´œì°®ì€': 'ê´œì°®ë‹¤', 'ê´œì°®': 'ê´œì°®ë‹¤',
            'ê´œì°®ê³ ': 'ê´œì°®ë‹¤', 'ê´œì°®ì•„ìš”': 'ê´œì°®ë‹¤', 'ê´œì°®ìŠµë‹ˆë‹¤': 'ê´œì°®ë‹¤',
            // ë§›ìˆë‹¤ ê³„ì—´ (í™•ì¥)
            'ë§›ìˆì–´': 'ë§›ìˆë‹¤', 'ë§›ìˆëŠ”': 'ë§›ìˆë‹¤', 'ë§›ìˆ': 'ë§›ìˆë‹¤',
            'ë§›ìˆê³ ': 'ë§›ìˆë‹¤', 'ë§›ìˆì–´ìš”': 'ë§›ìˆë‹¤', 'ë§›ìˆìŠµë‹ˆë‹¤': 'ë§›ìˆë‹¤',
            // ì¬ë°Œë‹¤ ê³„ì—´ (í™•ì¥)
            'ì¬ë°Œì–´': 'ì¬ë°Œë‹¤', 'ì¬ë°ŒëŠ”': 'ì¬ë°Œë‹¤', 'ì¬ë°Œ': 'ì¬ë°Œë‹¤',
            'ì¬ë°Œê³ ': 'ì¬ë°Œë‹¤', 'ì¬ë°Œì–´ìš”': 'ì¬ë°Œë‹¤', 'ì¬ë°ŒìŠµë‹ˆë‹¤': 'ì¬ë°Œë‹¤',
            // ì‹¸ë‹¤ ê³„ì—´ (í™•ì¥)
            'ì‹¸': 'ì‹¸ë‹¤', 'ì‹¼': 'ì‹¸ë‹¤', 'ì‹¸ê³ ': 'ì‹¸ë‹¤', 'ì‹¸ìš”': 'ì‹¸ë‹¤',
            // ë¹„ì‹¸ë‹¤ ê³„ì—´ (í™•ì¥)
            'ë¹„ì‹¸': 'ë¹„ì‹¸ë‹¤', 'ë¹„ì‹¼': 'ë¹„ì‹¸ë‹¤', 'ë¹„ì‹¸ê³ ': 'ë¹„ì‹¸ë‹¤', 'ë¹„ì‹¸ìš”': 'ë¹„ì‹¸ë‹¤',
            // í¬ë‹¤ ê³„ì—´ (í™•ì¥)
            'í¬': 'í¬ë‹¤', 'í°': 'í¬ë‹¤', 'í¬ê³ ': 'í¬ë‹¤', 'ì»¤ìš”': 'í¬ë‹¤', 'í½ë‹ˆë‹¤': 'í¬ë‹¤',
            // ì‘ë‹¤ ê³„ì—´ (í™•ì¥)
            'ì‘ì•„': 'ì‘ë‹¤', 'ì‘ì€': 'ì‘ë‹¤', 'ì‘': 'ì‘ë‹¤', 'ì‘ê³ ': 'ì‘ë‹¤',
            'ì‘ì•„ìš”': 'ì‘ë‹¤', 'ì‘ìŠµë‹ˆë‹¤': 'ì‘ë‹¤',
            // ë§ë‹¤ ê³„ì—´ (í™•ì¥ - ì¤‘ìš”!)
            'ë§ì•„': 'ë§ë‹¤', 'ë§ì€': 'ë§ë‹¤', 'ë§': 'ë§ë‹¤', 'ë§ê³ ': 'ë§ë‹¤',
            'ë§ì•„ìš”': 'ë§ë‹¤', 'ë§ìŠµë‹ˆë‹¤': 'ë§ë‹¤', 'ë§ë„¤ìš”': 'ë§ë‹¤',
            // ì ë‹¤ ê³„ì—´ (í™•ì¥)
            'ì ì–´': 'ì ë‹¤', 'ì ì€': 'ì ë‹¤', 'ì ': 'ì ë‹¤', 'ì ê³ ': 'ì ë‹¤',
            'ì ì–´ìš”': 'ì ë‹¤', 'ì ìŠµë‹ˆë‹¤': 'ì ë‹¤',
            // ë¹ ë¥´ë‹¤ ê³„ì—´ (í™•ì¥)
            'ë¹¨ë¼': 'ë¹ ë¥´ë‹¤', 'ë¹ ë¥¸': 'ë¹ ë¥´ë‹¤', 'ë¹¨ë¦¬': 'ë¹ ë¥´ë‹¤', 'ë¹ ë¥´ê³ ': 'ë¹ ë¥´ë‹¤',
            'ë¹¨ë¼ìš”': 'ë¹ ë¥´ë‹¤', 'ë¹ ë¦…ë‹ˆë‹¤': 'ë¹ ë¥´ë‹¤',
            // ëŠë¦¬ë‹¤ ê³„ì—´ (í™•ì¥)
            'ëŠë ¤': 'ëŠë¦¬ë‹¤', 'ëŠë¦°': 'ëŠë¦¬ë‹¤', 'ëŠë¦¬ê³ ': 'ëŠë¦¬ë‹¤', 'ëŠë ¤ìš”': 'ëŠë¦¬ë‹¤',
            // ì˜ˆì˜ë‹¤ ê³„ì—´ (í™•ì¥)
            'ì˜ˆì˜': 'ì˜ˆì˜ë‹¤', 'ì˜ˆìœ': 'ì˜ˆì˜ë‹¤', 'ì˜ˆì˜ê³ ': 'ì˜ˆì˜ë‹¤', 'ì˜ˆë»ìš”': 'ì˜ˆì˜ë‹¤',
            // ì•„ë¦„ë‹µë‹¤ ê³„ì—´ (í™•ì¥)
            'ì•„ë¦„ë‹¤ì›Œ': 'ì•„ë¦„ë‹µë‹¤', 'ì•„ë¦„ë‹¤ìš´': 'ì•„ë¦„ë‹µë‹¤', 'ì•„ë¦„ë‹µê³ ': 'ì•„ë¦„ë‹µë‹¤',
            // ì‰½ë‹¤ ê³„ì—´ (í™•ì¥)
            'ì‰¬ì›Œ': 'ì‰½ë‹¤', 'ì‰¬ìš´': 'ì‰½ë‹¤', 'ì‰½': 'ì‰½ë‹¤', 'ì‰½ê³ ': 'ì‰½ë‹¤',
            'ì‰¬ì›Œìš”': 'ì‰½ë‹¤', 'ì‰½ìŠµë‹ˆë‹¤': 'ì‰½ë‹¤',
            // ì–´ë µë‹¤ ê³„ì—´ (í™•ì¥)
            'ì–´ë ¤ì›Œ': 'ì–´ë µë‹¤', 'ì–´ë ¤ìš´': 'ì–´ë µë‹¤', 'ì–´ë µ': 'ì–´ë µë‹¤', 'ì–´ë µê³ ': 'ì–´ë µë‹¤',
            'ì–´ë ¤ì›Œìš”': 'ì–´ë µë‹¤', 'ì–´ë µìŠµë‹ˆë‹¤': 'ì–´ë µë‹¤',
            // ê°€ë³ë‹¤ ê³„ì—´ (í™•ì¥)
            'ê°€ë²¼ì›Œ': 'ê°€ë³ë‹¤', 'ê°€ë²¼ìš´': 'ê°€ë³ë‹¤', 'ê°€ë³ê³ ': 'ê°€ë³ë‹¤', 'ê°€ë²¼ì›Œìš”': 'ê°€ë³ë‹¤',
            // ë¬´ê²ë‹¤ ê³„ì—´ (í™•ì¥)
            'ë¬´ê±°ì›Œ': 'ë¬´ê²ë‹¤', 'ë¬´ê±°ìš´': 'ë¬´ê²ë‹¤', 'ë¬´ê²ê³ ': 'ë¬´ê²ë‹¤', 'ë¬´ê±°ì›Œìš”': 'ë¬´ê²ë‹¤',
            // ì°¨ë‹¤ ê³„ì—´ (í™•ì¥)
            'ì°¨': 'ì°¨ë‹¤', 'ì°¬': 'ì°¨ë‹¤', 'ì°¨ê³ ': 'ì°¨ë‹¤', 'ì°¨ìš”': 'ì°¨ë‹¤',
            // ë†€ë‹¤ ê³„ì—´ (í™•ì¥)
            'ë†€': 'ë†€ë‹¤', 'ë…¸': 'ë†€ë‹¤', 'ë…¸ëŠ”': 'ë†€ë‹¤', 'ë†€ê³ ': 'ë†€ë‹¤', 'ë†€ì•„ìš”': 'ë†€ë‹¤',
            // ì €ë ´í•˜ë‹¤ ê³„ì—´
            'ì €ë ´í•˜': 'ì €ë ´í•˜ë‹¤', 'ì €ë ´í•œ': 'ì €ë ´í•˜ë‹¤', 'ì €ë ´í•´': 'ì €ë ´í•˜ë‹¤', 'ì €ë ´í•˜ê³ ': 'ì €ë ´í•˜ë‹¤', 'ì €ë ´í•´ìš”': 'ì €ë ´í•˜ë‹¤',
            // ì•ˆì‹¬í•˜ë‹¤ ê³„ì—´
            'ì•ˆì‹¬í•˜': 'ì•ˆì‹¬í•˜ë‹¤', 'ì•ˆì‹¬í•´': 'ì•ˆì‹¬í•˜ë‹¤', 'ì•ˆì‹¬ë˜': 'ì•ˆì‹¬í•˜ë‹¤', 'ì•ˆì‹¬ë¼': 'ì•ˆì‹¬í•˜ë‹¤', 'ì•ˆì‹¬ë¼ìš”': 'ì•ˆì‹¬í•˜ë‹¤',
            // ìì„¸í•˜ë‹¤ ê³„ì—´
            'ìì„¸í•˜': 'ìì„¸í•˜ë‹¤', 'ìì„¸í•œ': 'ìì„¸í•˜ë‹¤', 'ìì„¸í•´': 'ìì„¸í•˜ë‹¤', 'ìì„¸í•´ìš”': 'ìì„¸í•˜ë‹¤',
            // ë‹¤ì–‘í•˜ë‹¤ ê³„ì—´
            'ë‹¤ì–‘í•˜': 'ë‹¤ì–‘í•˜ë‹¤', 'ë‹¤ì–‘í•œ': 'ë‹¤ì–‘í•˜ë‹¤', 'ë‹¤ì–‘í•´': 'ë‹¤ì–‘í•˜ë‹¤', 'ë‹¤ì–‘í•´ìš”': 'ë‹¤ì–‘í•˜ë‹¤',
            // ê°„ë‹¨í•˜ë‹¤ ê³„ì—´
            'ê°„ë‹¨í•˜': 'ê°„ë‹¨í•˜ë‹¤', 'ê°„ë‹¨í•œ': 'ê°„ë‹¨í•˜ë‹¤', 'ê°„ë‹¨í•´': 'ê°„ë‹¨í•˜ë‹¤', 'ê°„ë‹¨í•´ìš”': 'ê°„ë‹¨í•˜ë‹¤'
        };

        // í’ˆì‚¬ íƒœê·¸ ì •ì˜
        const posTagInfo = {
            'NNG': {
                name: 'ì¼ë°˜ëª…ì‚¬',
                desc: 'ì‚¬ë¬¼, ê°œë…, ì¥ì†Œ ë“±ì„ ë‚˜íƒ€ë‚´ëŠ” ì¼ë°˜ì ì¸ ëª…ì‚¬',
                examples: ['ì‚¬ê³¼', 'í•™êµ', 'ì‚¬ë‘', 'ì»´í“¨í„°', 'ì¹œêµ¬'],
                detail: 'ê°€ì¥ ê¸°ë³¸ì ì¸ ëª…ì‚¬ë¡œ, êµ¬ì²´ì ì´ê±°ë‚˜ ì¶”ìƒì ì¸ ëŒ€ìƒì„ ì§€ì¹­í•©ë‹ˆë‹¤. TF-IDF ë¶„ì„ì—ì„œ í•µì‹¬ í‚¤ì›Œë“œê°€ ë˜ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤.',
                selected: true
            },
            'NNP': {
                name: 'ê³ ìœ ëª…ì‚¬',
                desc: 'íŠ¹ì •í•œ ëŒ€ìƒì„ ê°€ë¦¬í‚¤ëŠ” ì´ë¦„',
                examples: ['ì„œìš¸', 'ëŒ€í•œë¯¼êµ­', 'ì‚¼ì„±', 'BTS', 'í•œê°•'],
                detail: 'ì‚¬ëŒ, ì¥ì†Œ, ì¡°ì§ ë“±ì˜ íŠ¹ì • ê³ ìœ í•œ ì´ë¦„ì…ë‹ˆë‹¤. ë¬¸ì„œì˜ ì£¼ì œë¥¼ íŒŒì•…í•˜ëŠ” ë° ì¤‘ìš”í•œ ì—­í• ì„ í•©ë‹ˆë‹¤.',
                selected: true
            },
            'NNB': {
                name: 'ì˜ì¡´ëª…ì‚¬',
                desc: 'ë‹¨ë…ìœ¼ë¡œ ì“°ì´ì§€ ì•Šê³  ë‹¤ë¥¸ ë§ì— ê¸°ëŒ€ì–´ ì“°ì´ëŠ” ëª…ì‚¬',
                examples: ['ê²ƒ', 'ìˆ˜', 'ë“±', 'ë°”', 'ì§€', 'ë°'],
                detail: 'ë°˜ë“œì‹œ ê´€í˜•ì–´ì˜ ìˆ˜ì‹ì„ ë°›ì•„ì•¼ í•˜ëŠ” ëª…ì‚¬ì…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ TF-IDF ë¶„ì„ì—ì„œëŠ” ì œì™¸í•˜ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤.',
                selected: false
            },
            'NR': {
                name: 'ìˆ˜ì‚¬',
                desc: 'ìˆ˜ëŸ‰ì´ë‚˜ ìˆœì„œë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë§',
                examples: ['í•˜ë‚˜', 'ë‘˜', 'ì²«ì§¸', 'ì œì¼', 'ì—´'],
                detail: 'ìˆ«ìë‚˜ ìˆœì„œë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ë¬¸ì„œì˜ ë‚´ìš©ì— ë”°ë¼ ì¤‘ìš”ë„ê°€ ë‹¬ë¼ì§‘ë‹ˆë‹¤.',
                selected: false
            },
            'NP': {
                name: 'ëŒ€ëª…ì‚¬',
                desc: 'ì‚¬ëŒì´ë‚˜ ì‚¬ë¬¼ì„ ëŒ€ì‹ í•˜ì—¬ ê°€ë¦¬í‚¤ëŠ” ë§',
                examples: ['ë‚˜', 'ë„ˆ', 'ìš°ë¦¬', 'ê·¸ê²ƒ', 'ì—¬ê¸°'],
                detail: 'ëª…ì‚¬ë¥¼ ëŒ€ì‹ í•˜ëŠ” ë§ì…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ TF-IDF ë¶„ì„ì—ì„œëŠ” ë¶ˆìš©ì–´ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤.',
                selected: false
            },
            'VV': {
                name: 'ë™ì‚¬',
                desc: 'ë™ì‘ì´ë‚˜ ì‘ìš©ì„ ë‚˜íƒ€ë‚´ëŠ” ë§',
                examples: ['ë¨¹ë‹¤', 'ê°€ë‹¤', 'ë§Œë“¤ë‹¤', 'ìƒê°í•˜ë‹¤', 'ë§í•˜ë‹¤'],
                detail: 'ì£¼ì–´ì˜ ë™ì‘ì´ë‚˜ ìƒíƒœë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ë¬¸ì„œì˜ í–‰ìœ„ë‚˜ í™œë™ì„ íŒŒì•…í•˜ëŠ” ë° ì¤‘ìš”í•©ë‹ˆë‹¤.',
                selected: true
            },
            'VA': {
                name: 'í˜•ìš©ì‚¬',
                desc: 'ì„±ì§ˆì´ë‚˜ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë§',
                examples: ['ì˜ˆì˜ë‹¤', 'í¬ë‹¤', 'ì¢‹ë‹¤', 'ë¹ ë¥´ë‹¤', 'ìƒˆë¡­ë‹¤'],
                detail: 'ì‚¬ë¬¼ì˜ ì„±ì§ˆ, ìƒíƒœë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ê°ì • ë¶„ì„ì´ë‚˜ ì˜ê²¬ ë§ˆì´ë‹ì—ì„œ ì¤‘ìš”í•œ ì—­í• ì„ í•©ë‹ˆë‹¤.',
                selected: true
            },
            'VX': {
                name: 'ë³´ì¡°ìš©ì–¸',
                desc: 'ë³¸ìš©ì–¸ì„ ë„ì™€ì£¼ëŠ” ìš©ì–¸',
                examples: ['í•˜ë‹¤', 'ë˜ë‹¤', 'ì‹¶ë‹¤', 'ë³´ë‹¤', 'ì£¼ë‹¤'],
                detail: 'ë‹¤ë¥¸ ìš©ì–¸ ë’¤ì—ì„œ ì˜ë¯¸ë¥¼ ë³´ì¡°í•©ë‹ˆë‹¤. ë‹¨ë…ìœ¼ë¡œëŠ” ì˜ë¯¸ê°€ ì•½í•˜ë¯€ë¡œ ì œì™¸í•˜ëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤.',
                selected: false
            },
            'VCP': {
                name: 'ê¸ì •ì§€ì •ì‚¬',
                desc: '"ì´ë‹¤"ë¥¼ ë‚˜íƒ€ë‚´ëŠ” í’ˆì‚¬',
                examples: ['ì´ë‹¤'],
                detail: 'ì²´ì–¸ ë’¤ì—ì„œ ì„œìˆ ì–´ ì—­í• ì„ í•©ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ë¶„ì„ì—ì„œ ì œì™¸ë©ë‹ˆë‹¤.',
                selected: false
            },
            'VCN': {
                name: 'ë¶€ì •ì§€ì •ì‚¬',
                desc: '"ì•„ë‹ˆë‹¤"ë¥¼ ë‚˜íƒ€ë‚´ëŠ” í’ˆì‚¬',
                examples: ['ì•„ë‹ˆë‹¤'],
                detail: 'ë¶€ì •ì„ ë‚˜íƒ€ë‚´ëŠ” ì§€ì •ì‚¬ì…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ë¶„ì„ì—ì„œ ì œì™¸ë©ë‹ˆë‹¤.',
                selected: false
            },
            'MM': {
                name: 'ê´€í˜•ì‚¬',
                desc: 'ì²´ì–¸ì„ ê¾¸ë©°ì£¼ëŠ” ë§',
                examples: ['ìƒˆ', 'í—Œ', 'ì´', 'ê·¸', 'ëª¨ë“ '],
                detail: 'ëª…ì‚¬ ì•ì—ì„œ ëª…ì‚¬ë¥¼ ìˆ˜ì‹í•©ë‹ˆë‹¤. TF-IDF ë¶„ì„ì—ì„œëŠ” ì£¼ë¡œ ì œì™¸ë©ë‹ˆë‹¤.',
                selected: false
            },
            'MAG': {
                name: 'ì¼ë°˜ë¶€ì‚¬',
                desc: 'ìš©ì–¸ì„ ê¾¸ë©°ì£¼ëŠ” ë§',
                examples: ['ë§¤ìš°', 'ì•„ì£¼', 'ë¹¨ë¦¬', 'ì²œì²œíˆ', 'ì •ë§'],
                detail: 'ë™ì‚¬ë‚˜ í˜•ìš©ì‚¬ë¥¼ ìˆ˜ì‹í•˜ì—¬ ì •ë„ë‚˜ ë°©ë²•ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.',
                selected: false
            },
            'MAJ': {
                name: 'ì ‘ì†ë¶€ì‚¬',
                desc: 'ë¬¸ì¥ì´ë‚˜ ë‹¨ì–´ë¥¼ ì´ì–´ì£¼ëŠ” ë¶€ì‚¬',
                examples: ['ê·¸ë¦¬ê³ ', 'í•˜ì§€ë§Œ', 'ê·¸ëŸ¬ë‚˜', 'ë˜ëŠ”', 'ì¦‰'],
                detail: 'ë¬¸ì¥ ê°„ì˜ ê´€ê³„ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ë¶„ì„ì—ì„œ ì œì™¸ë©ë‹ˆë‹¤.',
                selected: false
            },
            'IC': {
                name: 'ê°íƒ„ì‚¬',
                desc: 'ê°ì •ì´ë‚˜ ëŠë‚Œì„ ë‚˜íƒ€ë‚´ëŠ” ë§',
                examples: ['ì•„', 'ì™€', 'ì–´ë¨¸', 'í—', 'ì˜¤'],
                detail: 'ê°ì •ì´ë‚˜ ë¶€ë¦„, ëŒ€ë‹µ ë“±ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ê°ì • ë¶„ì„ì—ì„œ ìœ ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                selected: false
            },
            'SL': {
                name: 'ì™¸êµ­ì–´',
                desc: 'ì™¸êµ­ì–´ë¡œ ëœ ë‹¨ì–´',
                examples: ['AI', 'Python', 'Computer', 'Algorithm'],
                detail: 'ì˜ì–´ ë“± ì™¸êµ­ì–´ë¡œ ëœ ë‹¨ì–´ì…ë‹ˆë‹¤. ê¸°ìˆ  ë¬¸ì„œ ë¶„ì„ì—ì„œ ì¤‘ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                selected: true
            },
            'SH': {
                name: 'í•œì',
                desc: 'í•œìë¡œ í‘œê¸°ëœ ë‹¨ì–´',
                examples: ['æ¼¢å­—', 'å¤§éŸ“æ°‘åœ‹', 'å­¸æ ¡'],
                detail: 'í•œìë¡œ ì“°ì¸ ë‹¨ì–´ì…ë‹ˆë‹¤.',
                selected: false
            },
            'SN': {
                name: 'ìˆ«ì',
                desc: 'ì•„ë¼ë¹„ì•„ ìˆ«ì',
                examples: ['123', '2024', '3.14'],
                detail: 'ìˆ«ìë¡œ í‘œê¸°ëœ ë‹¨ì–´ì…ë‹ˆë‹¤. ë°ì´í„° ë¶„ì„ì—ì„œ ìœ ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.',
                selected: false
            },
            'JKS': {
                name: 'ì£¼ê²©ì¡°ì‚¬',
                desc: 'ì£¼ì–´ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì¡°ì‚¬',
                examples: ['ì´', 'ê°€', 'ì—ì„œ', 'ê»˜ì„œ'],
                detail: 'ì£¼ì–´ë¥¼ í‘œì‹œí•˜ëŠ” ì¡°ì‚¬ì…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ TF-IDF ë¶„ì„ì—ì„œëŠ” ì œì™¸ë©ë‹ˆë‹¤.',
                selected: false
            },
            'JKO': {
                name: 'ëª©ì ê²©ì¡°ì‚¬',
                desc: 'ëª©ì ì–´ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì¡°ì‚¬',
                examples: ['ì„', 'ë¥¼'],
                detail: 'ëª©ì ì–´ë¥¼ í‘œì‹œí•˜ëŠ” ì¡°ì‚¬ì…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ë¶„ì„ì—ì„œ ì œì™¸ë©ë‹ˆë‹¤.',
                selected: false
            },
            'JX': {
                name: 'ë³´ì¡°ì‚¬',
                desc: 'ì˜ë¯¸ë¥¼ ë³´ì¡°í•˜ëŠ” ì¡°ì‚¬',
                examples: ['ì€', 'ëŠ”', 'ë„', 'ë§Œ', 'ê¹Œì§€', 'ë¶€í„°'],
                detail: 'ëª…ì‚¬ì— íŠ¹ë³„í•œ ì˜ë¯¸ë¥¼ ë”í•˜ëŠ” ì¡°ì‚¬ì…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ë¶„ì„ì—ì„œ ì œì™¸ë©ë‹ˆë‹¤.',
                selected: false
            },
            'EF': {
                name: 'ì¢…ê²°ì–´ë¯¸',
                desc: 'ë¬¸ì¥ì„ ëë§ºëŠ” ì–´ë¯¸',
                examples: ['ë‹¤', 'ìŠµë‹ˆë‹¤', 'ã…‚ë‹ˆë‹¤'],
                detail: 'ë¬¸ì¥ì˜ ëì„ ë‚˜íƒ€ë‚´ëŠ” ì–´ë¯¸ì…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ë¶„ì„ì—ì„œ ì œì™¸ë©ë‹ˆë‹¤.',
                selected: false
            },
        };

        let selectedPosTags = new Set(
            Object.entries(posTagInfo)
                .filter(([tag, info]) => info.selected)
                .map(([tag]) => tag)
        );

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', async () => {
            renderFormulas();
            renderPosTagButtons();
            await initMeCab();
        });

        // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeModal();
            }
        });

        // MeCab ì´ˆê¸°í™”
        async function initMeCab() {
            try {
                updateStatus('loading', 'â³', 'í˜•íƒœì†Œ ë¶„ì„ê¸° ë¡œë”© ì¤‘...');

                mecab = new MeCabWrapper();
                await mecab.initialize();

                updateStatus('ready', 'âœ…', 'ì¤€ë¹„ ì™„ë£Œ');
                document.getElementById('analyzeBtn').disabled = false;
                document.getElementById('loadingOverlay').classList.add('hidden');

            } catch (error) {
                console.error('MeCab ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
                updateStatus('error', 'âŒ', 'ë¡œë”© ì‹¤íŒ¨');
                document.getElementById('loadingOverlay').innerHTML = `
                    <div style="text-align: center; padding: 40px;">
                        <div style="font-size: 4rem; margin-bottom: 20px;">âŒ</div>
                        <div style="font-size: 1.2rem; color: #991B1B; font-weight: 600; margin-bottom: 12px;">
                            í˜•íƒœì†Œ ë¶„ì„ê¸° ë¡œë”© ì‹¤íŒ¨
                        </div>
                        <div style="color: #64748B; margin-bottom: 20px;">
                            MeCab ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.<br>
                            í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.
                        </div>
                    </div>
                `;
            }
        }

        // ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateStatus(type, icon, text) {
            const badge = document.getElementById('statusBadge');
            const iconEl = document.getElementById('statusIcon');
            const textEl = document.getElementById('statusText');
            
            badge.className = 'status-badge ' + type;
            iconEl.textContent = icon;
            textEl.textContent = text;
        }

        // í’ˆì‚¬ íƒœê·¸ ë²„íŠ¼ ë Œë”ë§
        function renderPosTagButtons() {
            const container = document.getElementById('posTagsContainer');
            container.innerHTML = Object.entries(posTagInfo).map(([tag, info]) => `
                <div class="pos-tag-wrapper ${selectedPosTags.has(tag) ? 'active-wrapper' : ''}">
                    <button class="pos-tag-btn ${selectedPosTags.has(tag) ? 'active' : ''}"
                            onclick="togglePosTag('${tag}')"
                            title="${info.desc}">
                        ${info.name} (${tag})
                    </button>
                    <span class="pos-info-icon" onclick="showPosInfo('${tag}')" title="í’ˆì‚¬ ì„¤ëª… ë³´ê¸°">ğŸ”</span>
                </div>
            `).join('');
        }

        // í’ˆì‚¬ ì„¤ëª… ëª¨ë‹¬ ì—´ê¸°
        function showPosInfo(tag) {
            const info = posTagInfo[tag];
            const modal = document.getElementById('posModal');
            const title = document.getElementById('modalTitle');
            const body = document.getElementById('modalBody');

            title.innerHTML = `${info.name} <span style="color: #94a3b8; font-size: 1rem;">(${tag})</span>`;

            body.innerHTML = `
                <div class="modal-section">
                    <div class="modal-section-title">ğŸ“– ì •ì˜</div>
                    <div>${info.desc}</div>
                </div>

                <div class="modal-section">
                    <div class="modal-section-title">âœ¨ ì˜ˆì‹œ</div>
                    <div class="modal-examples">
                        ${info.examples.map(ex => `<div class="modal-example-item">â€¢ ${ex}</div>`).join('')}
                    </div>
                </div>

                <div class="modal-section">
                    <div class="modal-section-title">ğŸ’¡ TF-IDF ë¶„ì„ì—ì„œì˜ í™œìš©</div>
                    <div>${info.detail}</div>
                </div>

                <div class="modal-section">
                    <div style="background: ${selectedPosTags.has(tag) ? '#D1FAE5' : '#FEE2E2'};
                                padding: 12px; border-radius: 8px; text-align: center;">
                        <strong>${selectedPosTags.has(tag) ? 'âœ… í˜„ì¬ ì„ íƒë¨' : 'âŒ í˜„ì¬ ì„ íƒ ì•ˆ ë¨'}</strong>
                    </div>
                </div>
            `;

            modal.classList.add('show');
        }

        // ëª¨ë‹¬ ë‹«ê¸°
        function closeModal(event) {
            if (event && event.target !== event.currentTarget) return;
            const modal = document.getElementById('posModal');
            modal.classList.remove('show');
        }

        // í’ˆì‚¬ íƒœê·¸ í† ê¸€
        function togglePosTag(tag) {
            if (selectedPosTags.has(tag)) {
                selectedPosTags.delete(tag);
            } else {
                selectedPosTags.add(tag);
            }
            renderPosTagButtons();
            if (documents.length > 0 && mecab) {
                calculate();
            }
        }

        // KaTeXìœ¼ë¡œ ìˆ˜ì‹ ë Œë”ë§
        function renderFormulas() {
            katex.render("TF(t, d) = \\text{ë¬¸ì¥ } d \\text{ì—ì„œ ë‹¨ì–´ } t \\text{ì˜ ë“±ì¥ íšŸìˆ˜}", 
                document.getElementById('formula-tf'));
            katex.render("DF(t) = \\text{ë‹¨ì–´ } t \\text{ê°€ ë“±ì¥í•œ ë¬¸ì¥ì˜ ìˆ˜}", 
                document.getElementById('formula-df'));
            updateIdfFormula();
            updateTfidfFormula();
        }

        function updateIdfFormula() {
            const useLog = document.getElementById('useLog').checked;
            const formula = useLog 
                ? "IDF(t) = \\log\\frac{N}{DF(t)}"
                : "IDF(t) = \\frac{N}{DF(t)}";
            katex.render(formula, document.getElementById('formula-idf'));
        }

        function updateTfidfFormula() {
            const useLog = document.getElementById('useLog').checked;
            const formula = useLog
                ? "TF\\text{-}IDF(t, d) = TF(t, d) \\times \\log\\frac{N}{DF(t)}"
                : "TF\\text{-}IDF(t, d) = TF(t, d) \\times \\frac{N}{DF(t)}";
            katex.render(formula, document.getElementById('formula-tfidf'));
        }

        // ì˜ˆì‹œ ë¶ˆëŸ¬ì˜¤ê¸°
        function loadExample() {
            const examples = [
                `ì´ ê°•ì•„ì§€ ê°„ì‹ì€ ê°•ì•„ì§€ê°€ ì •ë§ ì¢‹ì•„í•˜ëŠ” ê°„ì‹ì´ì—ìš”.
ëƒ„ìƒˆë„ ì¢‹ì•„ìš”.
ì•Œë ˆë¥´ê¸° ê±±ì • ì—†ì´ ë¨¹ì¼ ìˆ˜ ìˆëŠ” ê°„ì‹ì´ë¼ì„œ ì•ˆì‹¬ë¼ìš”.
ìš°ë¦¬ ê°•ì•„ì§€ê°€ ìš”ì¦˜ ì…ë§›ì´ ì—†ì–´ì„œ ì‚¬ë´¤ì–´ìš”.
ê°•ì•„ì§€ ë°˜ì‘ì€ ê´œì°®ì•„ìš”.
ê°€ê²©ì€ ì¡°ê¸ˆ ìˆì§€ë§Œ ì„±ë¶„ì´ ë¯¿ì„ ë§Œí•´ìš”.
ì´ ê°„ì‹ì€ ì‚°ì±… í›„ì— ì£¼ë©´ ë°˜ì‘ì´ ì¢‹ì•„ìš”.`,
                `ì´ ìŠ¤ë§ˆíŠ¸í°ì€ ìŠ¤ë§ˆíŠ¸í° ì¤‘ì—ì„œë„ ì¹´ë©”ë¼ ì„±ëŠ¥ì´ ì •ë§ ì¢‹ì•„ìš”.
ë°°í„°ë¦¬ê°€ ì˜¤ë˜ê°€ì„œ í•˜ë£¨ ì¢…ì¼ ì¨ë„ ë¶ˆí¸í•˜ì§€ ì•Šì•„ìš”.
ìŠ¤ë§ˆíŠ¸í° ë””ìì¸ì´ ì˜ˆì˜ê³  ìŠ¤ë§ˆíŠ¸í° ë¬´ê²Œë„ ê°€ë²¼ì›Œìš”.
ì‚¬ì§„ì„ ìì£¼ ì°ëŠ” ì‚¬ëŒì—ê²Œ ì˜ ì–´ìš¸ë ¤ìš”.
ê°€ê²© ëŒ€ë¹„ ì„±ëŠ¥ì´ ê´œì°®ì€ ì œí’ˆì´ì—ìš”.`,
                `ì´ ë¬¸ì œì§‘ì€ ë¬¸ì œì§‘ ì„¤ëª…ì´ ìì„¸í•´ì„œ í˜¼ì ê³µë¶€í•˜ê¸° ì¢‹ì•„ìš”.
ì‹œí—˜ ëŒ€ë¹„ë¡œ í’€ê¸° ì¢‹ì€ ì±…ì´ì—ìš”.
ë‚œì´ë„ë„ ì ë‹¹í•´ìš”.
ìˆ˜í•™ ë¬¸ì œì§‘ì„ ì°¾ë‹¤ê°€ ì´ ë¬¸ì œì§‘ì„ ì„ íƒí–ˆì–´ìš”.
ë¬¸ì œ ìœ í˜•ì´ ë‹¤ì–‘í•´ì„œ ë°˜ë³µ í•™ìŠµì— ë„ì›€ì´ ë¼ìš”.
ê°œë… ì •ë¦¬ê°€ ì˜ ë˜ì–´ ìˆì–´ì„œ ì´í•´í•˜ê¸° ì‰¬ì›Œìš”.`,
                `ì´ ê²Œì„ì€ ê²Œì„ ê·¸ë˜í”½ì´ ì¢‹ì•„ì„œ ë³´ëŠ” ì¬ë¯¸ê°€ ìˆì–´ìš”.
ì¹œêµ¬ë‘ ê°™ì´ í•˜ë©´ í›¨ì”¬ ì¬ë°Œì–´ìš”.
ë©€í‹°í”Œë ˆì´ê°€ í•µì‹¬ì´ì—ìš”.
ê²Œì„ ë‚œì´ë„ê°€ ì ë‹¹í•´ì„œ ì˜¤ë˜ ì¦ê¸¸ ìˆ˜ ìˆëŠ” ê²Œì„ì´ì—ìš”.
ìŠ¤í† ë¦¬ê°€ ìƒê°ë³´ë‹¤ ëª°ì…ê° ìˆì–´ìš”.
ì¡°ì‘ì´ ê°„ë‹¨í•´ì„œ ì²˜ìŒ í•˜ëŠ” ì‚¬ëŒë„ ê´œì°®ì•„ìš”.`,
                `ì´ ì§‘ í”¼ìëŠ” í”¼ì ì¹˜ì¦ˆê°€ ë§ì•„ì„œ ì •ë§ ë§›ìˆì–´ìš”.
ê°€ê²©ì´ ì €ë ´í•´ì„œ í•™ìƒë“¤ì´ ë§ì´ ì™€ìš”.
ì¹œêµ¬ë“¤ì´ë‘ ë¨¹ê¸° ì¢‹ì€ í”¼ìì§‘ì´ì—ìš”.
í”¼ì í¬ê¸°ë„ ì»¤ìš”.
ì£¼ë¬¸í•˜ë©´ ìŒì‹ì´ ë¹¨ë¦¬ ë‚˜ì™€ì„œ ì¢‹ì•„ìš”.
ì ì‹¬ì‹œê°„ì— ê°€ë©´ ìë¦¬ê°€ ê¸ˆë°© ì°¨ìš”.`,
                `êµ­ì„¸ì²­ì´ ëŒ€í˜• ë² ì´ì»¤ë¦¬ì¹´í˜ì˜ ìš´ì˜ ì‹¤íƒœë¥¼ ì§‘ì¤‘ ì ê²€í•œë‹¤. ì´ëŠ” ê°€ì—…ìƒì†ê³µì œ ì œë„ê°€ í¸ë²• ìƒì†Â·ì¦ì—¬ ìˆ˜ë‹¨ìœ¼ë¡œ ì•…ìš©ëœë‹¤ëŠ” ì§€ì ì„ í™•ì¸í•˜ê¸° ìœ„í•œ ì¡°ì¹˜ë¡œ, 25ì¼ ì‹¤íƒœì¡°ì‚¬ ê³„íšì„ ë°œí‘œí–ˆë‹¤. ì¡°ì‚¬ ëŒ€ìƒì€ ìì‚° ê·œëª¨, ë¶€ë™ì‚° ë¹„ì¤‘, ë§¤ì¶œì•¡ ë“±ì„ ì¢…í•©í•´ ì„ ì •í•˜ë©°, íƒˆì„¸ í˜ì˜ê°€ ë°œê²¬ë  ê²½ìš° ë³„ë„ ì„¸ë¬´ì¡°ì‚¬ë¡œ ì „í™˜í•  ë°©ì¹¨ì´ë‹¤. ì¼ë¶€ ëŒ€í˜• ë² ì´ì»¤ë¦¬ì¹´í˜ëŠ” ì œê³¼ì ì—…ìœ¼ë¡œ ë“±ë¡í•´ ìƒì†ì„¸ ê°ë©´ í˜œíƒì„ ë°›ì•˜ì§€ë§Œ, ì‹¤ì œë¡œëŠ” ìŒë£Œ íŒë§¤ê°€ ì£¼ë¥¼ ì´ë£¨ëŠ” ê²ƒìœ¼ë¡œ ë“œëŸ¬ë‚¬ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ê²½ê¸°ë„ì˜ í•œ ë² ì´ì»¤ë¦¬ì¹´í˜ëŠ” ì œê³¼ì ì—…ìœ¼ë¡œ ë“±ë¡í–ˆìœ¼ë‚˜ ìŒë£Œ ì›ì¬ë£Œ ë§¤ì… ë¹„ì¤‘ì´ 2ë°° ì´ìƒ ë†’ì•˜ìœ¼ë©°, ì œê³¼ ì œí’ˆì€ ì™„ì œí’ˆ ì¼€ìµ ì†ŒëŸ‰ë§Œ íŒë§¤í–ˆë‹¤. ì´ëŸ¬í•œ ìš´ì˜ ë°©ì‹ì€ ê°€ì—…ìƒì†ê³µì œ ì œë„ì˜ ë³¸ë˜ ëª©ì ì„ í›¼ì†í•˜ê³  íƒˆì„¸ ê°€ëŠ¥ì„±ì„ ë‚´í¬í•˜ê³  ìˆì–´ êµ­ì„¸ì²­ì€ ì œë„ ê°œì„ ì„ ìœ„í•œ ê¸°ì´ˆ ìë£Œë¡œ í™œìš©í•  ê³„íšì´ë‹¤.`
            ];

            const randomExample = examples[Math.floor(Math.random() * examples.length)];
            const textarea = document.getElementById('documentsTextarea');
            textarea.value = randomExample;
        }

        // í˜•íƒœì†Œ ë¶„ì„
        function analyzeMorphemes(text) {
            if (!mecab) return [];

            try {
                const result = mecab.analyze(text);
                const morphemes = [];

                result.forEach(word => {
                    word.morphs.forEach(morph => {
                        let lex = morph.lex;
                        
                        // ëª¨ë“  í’ˆì‚¬ì— ëŒ€í•´ ìë™ ë³€í™˜ ì‚¬ì „ í™•ì¸
                        if (verbStemDict[lex]) {
                            lex = verbStemDict[lex];
                        }
                        
                        morphemes.push({
                            lex: lex,
                            tag: morph.tag,
                            selected: selectedPosTags.has(morph.tag),
                            original: lex !== morph.lex ? morph.lex : null // ë³€í™˜ëœ ê²½ìš°ë§Œ original ì €ì¥
                        });
                    });
                });

                return morphemes;
            } catch (error) {
                console.error('í˜•íƒœì†Œ ë¶„ì„ ì˜¤ë¥˜:', error);
                return [];
            }
        }

        // í˜•íƒœì†Œ ë¶„ì„ ê²°ê³¼ í‘œì‹œ
        function renderMorphemeResult(allMorphemes) {
            const container = document.getElementById('morphemeContent');
            const section = document.getElementById('morphemeResult');
            
            container.innerHTML = allMorphemes.map((morphemes, sentenceIdx) => `
                <div class="morpheme-sentence">
                    <div class="morpheme-sentence-label">ë¬¸ì¥ ${sentenceIdx + 1}</div>
                    <div class="morpheme-tokens">
                        ${morphemes.map((m, morphIdx) => {
                            const isStopWord = stopWords.has(m.lex);
                            const cssClass = isStopWord ? 'stopword' : (m.selected ? 'selected' : 'excluded');
                            const isAutoConverted = m.original && m.original !== m.lex; // ìë™ ë³€í™˜ë¨
                            
                            return `
                                <span class="morpheme-token-wrapper" style="position: relative; display: inline-block;">
                                    <span class="morpheme-token ${cssClass}" 
                                          style="cursor: pointer; position: relative; display: inline-flex; align-items: center;" 
                                          title="${isStopWord ? 'í´ë¦­í•˜ì—¬ ë¶ˆìš©ì–´ í•´ì œ' : 'í´ë¦­í•˜ì—¬ ë¶ˆìš©ì–´ ì¶”ê°€'}">
                                        <span onclick="toggleStopWord('${m.lex}')" style="display: inline-flex; align-items: center;">
                                            ${isAutoConverted ? `
                                                <span class="lex" style="position: relative;">
                                                    ${m.lex}
                                                    <span style="position: absolute; top: -10px; right: -8px; font-size: 0.6rem; color: #10B981; background: #D1FAE5; padding: 1px 4px; border-radius: 3px; white-space: nowrap;" title="ì›ë³¸: ${m.original}">
                                                        âœ“
                                                    </span>
                                                </span>
                                            ` : `
                                                <span class="lex">${m.lex}</span>
                                            `}
                                            <span class="tag">/${m.tag}</span>
                                        </span>
                                        <span class="edit-icon" 
                                              onclick="event.stopPropagation(); showEditBox(${sentenceIdx}, ${morphIdx}, this)" 
                                              title="ë‹¨ì–´ ìˆ˜ì •"
                                              style="margin-left: 4px; cursor: pointer; color: #3B82F6; font-size: 0.75rem; opacity: 0.7;">
                                            âœï¸
                                        </span>
                                    </span>
                                </span>
                            `;
                        }).join('')}
                    </div>
                </div>
            `).join('');
            
            section.style.display = 'block';
            renderStopWords();
        }

        // ì¸ë¼ì¸ í¸ì§‘ì°½ í‘œì‹œ
        function showEditBox(sentenceIdx, morphIdx, iconElement) {
            // ê¸°ì¡´ í¸ì§‘ì°½ì´ ìˆìœ¼ë©´ ì œê±°
            const existingBox = document.querySelector('.inline-edit-box');
            if (existingBox) {
                existingBox.remove();
            }

            const morpheme = allMorphemes[sentenceIdx][morphIdx];
            const currentLex = morpheme.lex;
            const originalLex = morpheme.original || currentLex;
            
            // í¸ì§‘ì°½ ìƒì„±
            const wrapper = iconElement.closest('.morpheme-token-wrapper');
            const editBox = document.createElement('div');
            editBox.className = 'inline-edit-box';
            editBox.innerHTML = `
                <div style="background: white; border: 2px solid #3B82F6; border-radius: 8px; padding: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); min-width: 200px;">
                    <div style="font-size: 0.85rem; color: #64748B; margin-bottom: 8px;">
                        ${originalLex !== currentLex ? `ì›ë³¸: <strong>${originalLex}</strong><br>` : ''}
                        í˜„ì¬: <strong>${currentLex}</strong>
                    </div>
                    <input type="text" 
                           id="editInput_${sentenceIdx}_${morphIdx}" 
                           value="${currentLex}" 
                           style="width: 100%; padding: 8px; border: 1px solid #CBD5E1; border-radius: 4px; font-size: 0.95rem; margin-bottom: 8px;"
                           placeholder="ìƒˆë¡œìš´ ë‹¨ì–´ ì…ë ¥">
                    <div style="display: flex; gap: 6px;">
                        <button onclick="applyEdit(${sentenceIdx}, ${morphIdx})" 
                                style="flex: 1; background: #3B82F6; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 0.85rem;">
                            í™•ì¸
                        </button>
                        <button onclick="cancelEdit()" 
                                style="flex: 1; background: #E2E8F0; color: #475569; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 0.85rem;">
                            ì·¨ì†Œ
                        </button>
                    </div>
                </div>
            `;
            
            editBox.style.position = 'absolute';
            editBox.style.top = '100%';
            editBox.style.left = '0';
            editBox.style.marginTop = '4px';
            editBox.style.zIndex = '1000';
            
            wrapper.appendChild(editBox);
            
            // ì…ë ¥ì°½ì— í¬ì»¤ìŠ¤
            const input = document.getElementById(`editInput_${sentenceIdx}_${morphIdx}`);
            input.focus();
            input.select();
            
            // Enter í‚¤ë¡œ í™•ì¸
            input.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    applyEdit(sentenceIdx, morphIdx);
                }
            });
            
            // ESC í‚¤ë¡œ ì·¨ì†Œ
            input.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    cancelEdit();
                }
            });
        }

        // í¸ì§‘ ì ìš©
        function applyEdit(sentenceIdx, morphIdx) {
            const input = document.getElementById(`editInput_${sentenceIdx}_${morphIdx}`);
            const newLex = input.value.trim();
            const morpheme = allMorphemes[sentenceIdx][morphIdx];
            const currentLex = morpheme.lex;
            
            if (newLex !== '' && newLex !== currentLex) {
                // originalì´ ì—†ìœ¼ë©´ í˜„ì¬ lexë¥¼ originalë¡œ ì €ì¥
                if (!morpheme.original) {
                    morpheme.original = currentLex;
                }
                morpheme.lex = newLex;
            }
            
            cancelEdit();
            renderMorphemeResult(allMorphemes);
        }

        // í¸ì§‘ ì·¨ì†Œ
        function cancelEdit() {
            const editBox = document.querySelector('.inline-edit-box');
            if (editBox) {
                editBox.remove();
            }
        }

        // ì™¸ë¶€ í´ë¦­ ì‹œ í¸ì§‘ì°½ ë‹«ê¸°
        document.addEventListener('click', (e) => {
            const editBox = document.querySelector('.inline-edit-box');
            if (editBox && !editBox.contains(e.target) && !e.target.closest('.edit-icon')) {
                cancelEdit();
            }
        });

        // ë¶ˆìš©ì–´ í† ê¸€
        function toggleStopWord(word) {
            if (stopWords.has(word)) {
                stopWords.delete(word);
            } else {
                stopWords.add(word);
            }
            // í˜•íƒœì†Œ ë¶„ì„ ê²°ê³¼ë§Œ ë‹¤ì‹œ ë Œë”ë§ (ì¬ê³„ì‚° ì•ˆ í•¨)
            renderMorphemeResult(allMorphemes);
        }

        // ë¶ˆìš©ì–´ ëª©ë¡ ë Œë”ë§
        function renderStopWords() {
            let stopWordsSection = document.getElementById('stopWordsSection');
            
            // ì„¹ì…˜ì´ ì—†ìœ¼ë©´ ìƒì„±
            if (!stopWordsSection) {
                const morphemeResult = document.getElementById('morphemeResult');
                stopWordsSection = document.createElement('div');
                stopWordsSection.id = 'stopWordsSection';
                stopWordsSection.style.marginTop = '16px';
                stopWordsSection.style.paddingTop = '16px';
                stopWordsSection.style.borderTop = '1px solid var(--border)';
                morphemeResult.appendChild(stopWordsSection);
            }
            
            if (stopWords.size === 0) {
                stopWordsSection.innerHTML = `
                    <div class="preview-title">ğŸš« ë¶ˆìš©ì–´ ëª©ë¡ (í´ë¦­í•˜ì—¬ ì œê±°)</div>
                    <div style="color: var(--text-light); font-size: 0.9rem; padding: 12px; text-align: center;">
                        í˜•íƒœì†Œë¥¼ í´ë¦­í•˜ì—¬ ë¶ˆìš©ì–´ë¡œ ì§€ì •í•˜ì„¸ìš”
                    </div>
                `;
            } else {
                const stopWordsList = Array.from(stopWords).sort();
                stopWordsSection.innerHTML = `
                    <div class="preview-title">ğŸš« ë¶ˆìš©ì–´ ëª©ë¡ (<span style="color: var(--primary);">${stopWords.size}</span>ê°œ) - í´ë¦­í•˜ì—¬ ì œê±°</div>
                    <div class="preview-tokens">
                        ${stopWordsList.map(word => `
                            <span class="token stopword-tag" 
                                  onclick="toggleStopWord('${word}')" 
                                  style="cursor: pointer; background: #FEE2E2; color: #991B1B;"
                                  title="í´ë¦­í•˜ì—¬ ì œê±°">
                                ${word} âœ•
                            </span>
                        `).join('')}
                    </div>
                    <button class="btn btn-secondary btn-small" onclick="clearStopWords()" style="margin-top: 12px;">
                        ì „ì²´ ë¶ˆìš©ì–´ ì´ˆê¸°í™”
                    </button>
                `;
            }
        }

        // ì „ì²´ ë¶ˆìš©ì–´ ì´ˆê¸°í™”
        function clearStopWords() {
            if (stopWords.size === 0) return;
            if (confirm('ëª¨ë“  ë¶ˆìš©ì–´ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                stopWords.clear();
                renderMorphemeResult(allMorphemes);
            }
        }

        // ë‹¨ì–´ ì‚¬ì „ ë Œë”ë§
        function renderVocabulary(vocabulary, docWords) {
            const container = document.getElementById('vocabularyTokens');
            const countEl = document.getElementById('vocabCount');
            const card = document.getElementById('dictionaryCard');

            countEl.textContent = vocabulary.length;

            container.innerHTML = vocabulary.map((token, index) => {
                // ì´ ë‹¨ì–´ê°€ ë“±ì¥í•˜ëŠ” ë¬¸ì¥ ë²ˆí˜¸ ì°¾ê¸°
                const docIndices = [];
                docWords.forEach((words, docIndex) => {
                    if (words.includes(token)) {
                        docIndices.push(docIndex + 1);
                    }
                });

                const docBadges = docIndices.map(n =>
                    `<span style="background: #E0E7FF; color: #4338CA; padding: 2px 6px; border-radius: 4px; font-size: 0.7rem; margin-left: 4px;">ë¬¸ì¥${n}</span>`
                ).join('');

                return `
                    <span class="token" style="position: relative; display: inline-flex; align-items: center;">
                        <span style="font-size: 0.7rem; color: #94a3b8; margin-right: 4px;">${index + 1}.</span>
                        <strong>${token}</strong>
                        ${docBadges}
                    </span>
                `;
            }).join('');

            card.style.display = 'block';
            // card.scrollIntoView({ behavior: 'smooth', block: 'nearest' }); // ìŠ¤í¬ë¡¤ ì œê±°
        }

        // ì¶”ì¶œëœ ë‹¨ì–´ ë¯¸ë¦¬ë³´ê¸°
        function renderPreview(allTokens) {
            const container = document.getElementById('previewTokens');
            const section = document.getElementById('previewSection');

            const uniqueTokens = [...new Set(allTokens.flat())].sort();

            container.innerHTML = uniqueTokens.map(token => `
                <span class="token">${token}</span>
            `).join('');

            section.style.display = 'block';
        }

        // Step 1: í˜•íƒœì†Œ ë¶„ì„í•˜ê¸°
        function analyzeSentences() {
            if (!mecab) {
                alert('í˜•íƒœì†Œ ë¶„ì„ê¸°ê°€ ì•„ì§ ë¡œë”©ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
                return;
            }

            // textareaì—ì„œ ë¬¸ì¥ ìˆ˜ì§‘
            const textarea = document.getElementById('documentsTextarea');
            const textLines = textarea.value
                .split('\n')
                .map(line => line.trim())
                .filter(text => text.length > 0);
            
            // ê° ì¤„ì„ ë§ˆì¹¨í‘œë¡œ ì¶”ê°€ ë¶„ë¦¬ (ë¬¸ì¥ êµ¬ë¶„ ê°œì„ )
            documents = [];
            textLines.forEach(line => {
                // ë§ˆì¹¨í‘œë¡œ ë¬¸ì¥ ë¶„ë¦¬ (ë§ˆì¹¨í‘œ + ê³µë°± ë˜ëŠ” ë§ˆì¹¨í‘œê°€ ë)
                const sentences = line.split(/\.\s+|\.$/)
                    .map(s => s.trim())
                    .filter(s => s.length > 0);
                
                sentences.forEach(sentence => {
                    // ë§ˆì¹¨í‘œê°€ ì œê±°ë˜ì—ˆìœ¼ë¯€ë¡œ ë‹¤ì‹œ ì¶”ê°€ (ì„ íƒì )
                    if (!sentence.endsWith('.')) {
                        sentence = sentence + '.';
                    }
                    documents.push(sentence);
                });
            });

            if (documents.length < 2) {
                alert('ìµœì†Œ 2ê°œì˜ ë¬¸ì¥ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            // í˜•íƒœì†Œ ë¶„ì„
            allMorphemes = documents.map(doc => analyzeMorphemes(doc));
            renderMorphemeResult(allMorphemes);
        }

        // Step 2: TF-IDF ê³„ì‚° ì‹¤í–‰
        function calculate() {
            if (!allMorphemes || allMorphemes.length === 0) {
                alert('ë¨¼ì € í˜•íƒœì†Œ ë¶„ì„ì„ ìˆ˜í–‰í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ì„ íƒëœ í’ˆì‚¬ë§Œ ì¶”ì¶œí•˜ì—¬ ë‹¨ì–´ ì‚¬ì „ êµ¬ì¶• (ë¶ˆìš©ì–´ ì œì™¸)
            const wordSet = new Set();
            const docWords = allMorphemes.map(morphemes => {
                const tokens = morphemes
                    .filter(m => m.selected && !stopWords.has(m.lex)) // ë¶ˆìš©ì–´ ì œì™¸
                    .map(m => m.lex);
                tokens.forEach(w => wordSet.add(w));
                return tokens;
            });
            words = Array.from(wordSet).sort();

            if (words.length === 0) {
                alert('ì¶”ì¶œëœ ë‹¨ì–´ê°€ ì—†ìŠµë‹ˆë‹¤. í’ˆì‚¬ ì„ íƒì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
                return;
            }

            // ë‹¨ì–´ ì‚¬ì „ í‘œì‹œ ì œê±° (í•™ìƒë“¤ì—ê²Œ ë³´ì—¬ì¤„ í•„ìš” ì—†ìŒ)
            // renderVocabulary(words, docWords);

            // ë¯¸ë¦¬ë³´ê¸°
            renderPreview(docWords);

            // TF ê³„ì‚°
            tfMatrix = documents.map((doc, i) => {
                const row = {};
                words.forEach(word => {
                    row[word] = docWords[i].filter(w => w === word).length;
                });
                return row;
            });

            // DF ê³„ì‚°
            dfVector = {};
            words.forEach(word => {
                dfVector[word] = documents.filter((doc, i) => tfMatrix[i][word] > 0).length;
            });

            // IDF ê³„ì‚°
            const useLog = document.getElementById('useLog').checked;
            const N = documents.length;
            idfVector = {};
            words.forEach(word => {
                const df = dfVector[word];
                if (useLog) {
                    idfVector[word] = Math.log10(N / df);
                } else {
                    idfVector[word] = N / df;
                }
            });

            // TF-IDF ê³„ì‚°
            tfidfMatrix = tfMatrix.map(row => {
                const tfidfRow = {};
                words.forEach(word => {
                    tfidfRow[word] = row[word] * idfVector[word];
                });
                return tfidfRow;
            });

            // ìˆ˜ì‹ ì—…ë°ì´íŠ¸
            updateIdfFormula();
            updateTfidfFormula();

            // í…Œì´ë¸” ë Œë”ë§
            renderTables();

            // ê²°ê³¼ ì¹´ë“œ í‘œì‹œ
            document.getElementById('resultCard').style.display = 'block';
            // document.getElementById('resultCard').scrollIntoView({ behavior: 'smooth' }); // ìŠ¤í¬ë¡¤ ì œê±°
        }

        // í…Œì´ë¸” ë Œë”ë§
        function renderTables() {
            renderTfTable();
            renderDfTable();
            renderIdfTable();
            renderTfidfTable();
        }

        // TF í…Œì´ë¸”
        function renderTfTable() {
            const table = document.getElementById('tfTable');
            let html = '<thead><tr><th></th>';
            words.forEach(word => {
                html += `<th class="clickable-word" onclick="selectWord('${word}')">${word}</th>`;
            });
            html += '</tr></thead><tbody>';

            tfMatrix.forEach((row, i) => {
                html += `<tr><td>ë¬¸ì¥ ${i + 1}</td>`;
                words.forEach(word => {
                    const value = row[word];
                    const cls = selectedWord === word ? 'selected-word' : '';
                    html += `<td class="${cls}">${value}</td>`;
                });
                html += '</tr>';
            });

            // ì´í•©ê³„ í–‰ ì¶”ê°€
            html += '<tr style="background: #FEF3C7; font-weight: 700;"><td style="background: #FCD34D; color: #92400E;">ì´í•©ê³„</td>';
            words.forEach(word => {
                let sum = 0;
                tfMatrix.forEach(row => {
                    sum += row[word];
                });
                const cls = selectedWord === word ? 'selected-word' : '';
                html += `<td class="${cls}" style="color: #92400E;">${sum}</td>`;
            });
            html += '</tr>';

            html += '</tbody>';
            table.innerHTML = html;
        }

        // DF í…Œì´ë¸”
        function renderDfTable() {
            const table = document.getElementById('dfTable');
            let html = '<thead><tr><th></th>';
            words.forEach(word => {
                html += `<th class="clickable-word" onclick="selectWord('${word}')">${word}</th>`;
            });
            html += '</tr></thead><tbody>';

            html += '<tr class="df-row"><td>DF</td>';
            words.forEach(word => {
                const cls = selectedWord === word ? 'selected-word' : '';
                html += `<td class="${cls}">${dfVector[word]}</td>`;
            });
            html += '</tr>';

            html += '<tr><td style="white-space: nowrap;">N<br>(ë¬¸ì¥ ìˆ˜)</td>';
            html += `<td colspan="${words.length}" style="text-align:center; font-weight:600; color: var(--primary);">${documents.length}</td>`;
            html += '</tr>';

            html += '</tbody>';
            table.innerHTML = html;
        }

        // IDF í…Œì´ë¸”
        function renderIdfTable() {
            const table = document.getElementById('idfTable');
            const useLog = document.getElementById('useLog').checked;
            
            let html = '<thead><tr><th></th>';
            words.forEach(word => {
                html += `<th class="clickable-word" onclick="selectWord('${word}')">${word}</th>`;
            });
            html += '</tr></thead><tbody>';

            html += '<tr class="df-row"><td>DF</td>';
            words.forEach(word => {
                const cls = selectedWord === word ? 'selected-word' : '';
                html += `<td class="${cls}">${dfVector[word]}</td>`;
            });
            html += '</tr>';

            html += '<tr><td>N / DF</td>';
            words.forEach(word => {
                const value = documents.length / dfVector[word];
                const cls = selectedWord === word ? 'selected-word' : '';
                html += `<td class="${cls}">${value.toFixed(2)}</td>`;
            });
            html += '</tr>';

            html += '<tr class="idf-row"><td>IDF' + (useLog ? ' (logâ‚â‚€)' : '') + '</td>';
            words.forEach(word => {
                const cls = selectedWord === word ? 'selected-word' : '';
                html += `<td class="${cls}">${idfVector[word].toFixed(3)}</td>`;
            });
            html += '</tr>';

            html += '</tbody>';
            table.innerHTML = html;
        }

        // TF-IDF í…Œì´ë¸” (íˆíŠ¸ë§µ)
        function renderTfidfTable() {
            let maxValue = 0;
            tfidfMatrix.forEach(row => {
                words.forEach(word => {
                    if (row[word] > maxValue) maxValue = row[word];
                });
            });

            const table = document.getElementById('tfidfTable');
            let html = '<thead><tr><th></th>';
            words.forEach(word => {
                html += `<th class="clickable-word" onclick="selectWord('${word}')">${word}</th>`;
            });
            html += '</tr></thead><tbody>';

            tfidfMatrix.forEach((row, i) => {
                html += `<tr><td>ë¬¸ì¥ ${i + 1}</td>`;
                words.forEach(word => {
                    const value = row[word];
                    const heatLevel = maxValue > 0 ? Math.floor((value / maxValue) * 9) : 0;
                    const cls = selectedWord === word ? 'selected-word' : `heat-${heatLevel}`;
                    html += `<td class="${cls}">${value.toFixed(2)}</td>`;
                });
                html += '</tr>';
            });
            html += '</tbody>';
            table.innerHTML = html;

            const legend = document.getElementById('legend');
            legend.innerHTML = '<span style="margin-right: 8px;">ê°’ í¬ê¸°:</span>';
            for (let i = 0; i <= 9; i += 3) {
                const percent = Math.round((i / 9) * 100);
                legend.innerHTML += `
                    <div class="legend-item">
                        <div class="legend-color heat-${i}"></div>
                        <span>${percent}%</span>
                    </div>
                `;
            }
        }

        // ë‹¨ì–´ ì„ íƒ
        function selectWord(word) {
            selectedWord = selectedWord === word ? null : word;
            renderTables();
        }

        // íƒ­ ì „í™˜
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));

            event.target.classList.add('active');
            document.getElementById(`tab-${tabName}`).classList.add('active');
        }

        // useLog ë³€ê²½ ì‹œ ì¬ê³„ì‚°
        document.getElementById('useLog').addEventListener('change', () => {
            if (documents.length > 0 && mecab) calculate();
        });
    </script>
</body>
</html>
